//-----------------------------------------------------------------------------------------------------------------------------------------
//Obtention of Lichdom
//-----------------------------------------------------------------------------------------------------------------------------------------
new entry "PoU_Phylactery_Purchase"
type "Object"
using "OBJ_Indestructible_Tiny"
data "StatusInInventory" "PATHOFUNDEATH_L_FLASK"
data "ValueOverride" "20000"

new entry "PATHOFUNDEATH_L_FLASK"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

//Hidden technical status
//Obtained by studying the decoded Necromancy of Thay via Script Extender
//Gives the spell to become a Lich
new entry "PATHOFUNDEATH_L_UNLOCKER"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h0a252d10gac2ag459ega543g54c4a9dcb79b;1"
data "Description" "h01a50e21g1f28g460ag8846g690992f6b90f;1"
data "Icon" "PoU_4_LichdomPreparations"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;IgnoreResting;ApplyToDead"
data "OnApplyFunctors" "ApplyStatus(PATHOFUNDEATH_L_THAYAN,100,-1)"
data "TickFunctors" "IF(HasStatus('PATHOFUNDEATH_GREATERUNDEATH') and HasStatus('PATHOFUNDEATH_L_FLASK') and not HasStatus('PATHOFUNDEATH_L_PREPARATIONS')):ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_SPELL,100,-1)"
data "ApplyEffect" "4dd1bc13-5d02-45f5-bc6b-2fb8035521ac"
data "StackId" "PATHOFUNDEATH_L_TRANSFORM"
data "StackType" "Overwrite"
data "StackPriority" "10"

new entry "PATHOFUNDEATH_L_THAYAN"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "Passives" "PathOfUndeath_Thayan"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

new entry "PathOfUndeath_Thayan"
type "PassiveData"
data "DisplayName" "h0a252d10gac2ag459ega543g54c4a9dcb79b;1"
data "Description" "h276ddab8gd9c3g4b01g9686g056dbe835e16;1"
data "Icon" "PoU_4_Thayan"
data "Boosts" "ActionResource(ShadowSpellSlot,1,6)"
data "Properties" "Highlighted"

new entry "PATHOFUNDEATH_L_TRANSFORM_SPELL"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "Boosts" "UnlockSpell(PathOfUndeath_Shout_Lichdom)"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

//Character must drink Lost Time then Heart of Stone, and endure the ordeal
//Every turn for 10 turns, character must succeed a 25 wisdom saving throw
//Only successes allow the duration to shorten 
new entry "PathOfUndeath_Shout_Lichdom"
type "SpellData"
data "SpellType" "Shout"
data "DisplayName" "h7c6f191bgf06dg4e37gb020g5e7367833122;1"
data "Description" "h4c413df1gb909g4838ga905g7e9ba81fdad3;1"
data "Icon" "PoU_4_LichdomSpell"
data "Level" "9"
data "SpellSchool" "Necromancy"
data "SpellProperties" "ApplyStatus(PATHOFUNDEATH_L_PREPARATIONS,100,-1);RemoveStatus(PATHOFUNDEATH_L_TRANSFORM_SPELL);RemoveStatus(PATHOFUNDEATH_L_UNLOCKER)"
data "TargetConditions" "Self()"
data "PrepareSound" "Spell_Prepare_Damage_Radiant_Gen_L1to3"
data "PrepareLoopSound" "Spell_Prepare_Damage_Radiant_Gen_L1to3_Loop"
data "CastSound" "Spell_Cast_Buff_BladeWard_L1to3"
data "TargetSound" "Spell_Impact_Buff_BladeWard_L1to3"
data "PreviewCursor" "Cast"
data "CastTextEvent" "Cast"
data "UseCosts" "ActionPoint:1"
data "VerbalIntent" "Buff"
data "SpellFlags" "HasVerbalComponent;HasSomaticComponent;IsSpell"
data "HitAnimationType" "MagicalNonDamage"
data "SpellAnimation" "2f0d97b9-4a1f-4bf3-a3c2-32efb563d601,,;,,;6a95a81d-62e7-4b68-9b45-7e42e538dbde,,;815364ff-bbaa-4efc-b10e-f31043fafd6e,,;57e449b3-b712-4508-afcf-f2e91dc473f6,,;,,;84f3727f-aabc-4e34-bf31-c6cd0160bec9,,;,,;,,"
data "PrepareEffect" "5d4a5adb-db3a-47ed-9c29-b84e09425921"
data "CastEffect" "c582c3b6-2758-4d72-81f6-e45f07519a10"
data "TargetEffect" "e7b6ad82-c85a-40ac-9781-cb85f2dffb89"
data "RequirementConditions" "HasStatus('TRAVELBLOCK_CAMPNIGHTMODE') and not HasStatus('PATHOFUNDEATH_L_PREPARATIONS')"
data "TooltipPermanentWarnings" "b7e93760-8253-4130-a8cb-05c2c0bc01cb"

new entry "PATHOFUNDEATH_L_PREPARATIONS"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h78540212g9d00g4afdg855eg942b8db6d577;1"
data "Description" "hd1f5f597gd82eg4b4eg81ccg8090014ee09b;1"
data "Icon" "PoU_4_LichdomPreparations"
data "StatusPropertyFlags" "IgnoreResting;ApplyToDead"
data "StackId" "PATHOFUNDEATH_L_TRANSFORM"
data "StackType" "Overwrite"
data "StackPriority" "20"

new entry "PoU_Phylactery"
type "Object"
using "OBJ_Indestructible_Tiny"
data "ValueOverride" "0"

new entry "PATHOFUNDEATH_BOUND_PHYLACTERY"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hb90cef1bgd3e1g4990ga3d8g368a327e452c;1"
data "Description" "h4edd2d1agdab4g41aaga114g2c9035001938;1"
data "Icon" "statIcons_Bound"
data "StackId" "PATHOFUNDEATH_BOUND_PHYLACTERY"
data "Boosts" "Attribute(InventoryBound)"

//Can't be removed
new entry "HAG_LOST_TIME"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h718f5ac1g2808g4cb0g87ddg0fef0559255a;1"
data "Description" "h0d3941e4gc55cg47e7ga0d5gbe16f11206e1;1"
data "Icon" "Item_CONS_Hag_Lost_Time"
data "Boosts" "AC(-2); ActionResourceBlock(ReactionActionPoint)"
data "OnRemoveFunctors" "IF(HasStatus('PATHOFUNDEATH_L_RITUAL')):ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_FAILED,100,-1)"

new entry "HAG_HEART_OF_STONE"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hfc06aca9g0a63g4580gbbdeg971b8aad5117;1"
data "Description" "h22100c4dge6e0g4e1dgb48eg4cc6b7cdcf69;1"
data "Icon" "Item_CONS_Potion_Tribal_A_Greater"
data "BoostConditions" "HasStatus('HAG_LOST_TIME',context.Source) and HasStatus('PATHOFUNDEATH_L_FLASK',context.Source) and HasStatus('PATHOFUNDEATH_L_PREPARATIONS',context.Source)"
data "Boosts" "UnlockSpell(PathOfUndeath_Shout_Lichdom_2)"
data "StatusEffect" "164bf782-7f60-4b65-91b1-a31c152c05c3"

new entry "PathOfUndeath_Shout_Lichdom_2"
type "SpellData"
data "SpellType" "Shout"
using "PathOfUndeath_Shout_Lichdom"
data "DisplayName" "h958472f2g3b93g4784gb16bg2db36c27018f;1"
data "Description" "hb1f862c0gf7beg4d15g84a8g5e24c718f282;1"
data "Level" "9"
data "SpellProperties" "RemoveStatus(HAG_HEART_OF_STONE);ApplyStatus(PATHOFUNDEATH_L_RITUAL,100,10);"
data "RequirementConditions" ""

new entry "PATHOFUNDEATH_L_RITUAL"
type "StatusData"
data "StatusType" "INCAPACITATED"
data "DisplayName" "habeec62bgb04dg471fg94c4gf45f61be809e;1"
data "Description" "h22100c4dge6e0g4e1dgb48eg4cc6b7cdcf69;1"
data "Icon" "Item_CONS_Potion_Tribal_A_Greater"
data "Boosts" "DamageReduction(All,Flat,100);DetectDisturbancesBlock(true);Tag(BLOCK_PICKPOCKET);Tag(DOWNED_DISABLED);StatusImmunity(DISARM)"
data "StatusPropertyFlags" "InitiateCombat;IgnoreResting;FreezeDuration"
data "StatusGroups" ""
data "OnRemoveFunctors" "IF(HasStatus('HAG_LOST_TIME')):ApplyStatus(PATHOFUNDEATH_LICHDOM,100,-1);IF(RemoveCause(StatusRemoveCause.Death)):SwitchDeathType(Disintegrate);"
data "TickFunctors" "IF(HasStatus('HAG_LOST_TIME')):ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_TICK,100,0)"
data "OnApplyFunctors" "BreakConcentration();IF(HasStatus('HAG_LOST_TIME')):ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_VFX,100,-1);RemoveStatus(PATHOFUNDEATH_L_PREPARATIONS);SetStatusDuration(HAG_LOST_TIME,20,ForceSet);SetStatusDuration(HAG_HEART_OF_STONE,10,ForceSet)"
data "AnimationStart" "c7c71ac1-90c4-40f3-ac89-b5b134f4842c(STAT_CrystalizedInBlood_Start)"
data "AnimationLoop" "f444a369-c772-4182-bdea-ecbcc7317bcc(STAT_CrystalizedInBlood_Loop)"
data "AnimationEnd" "8bd74d95-b967-49ff-8d64-0b50c98e8d8b(STAT_CrystalizedInBlood_End)"
data "MaterialType" "FadingOverlay"
data "MaterialApplyBody" "Yes"
data "MaterialApplyArmor" "Yes"
data "MaterialApplyWeapon" "Yes"
data "MaterialApplyNormalMap" "Yes"
data "MaterialFadeAmount" "3000"
data "MaterialParameters" "CharacterHeight:Height"
data "SoundLoop" "Misc_Status_Petrified_MO"
data "SoundStop" "Misc_Status_Petrified_MO"
data "FreezeTime" "1500"
data "StatusEffect" "164bf782-7f60-4b65-91b1-a31c152c05c3"
data "StatusSoundState" "dd94cbd2-99a4-4a03-9fa7-caa7886552d1"
data "StackId" "PATHOFUNDEATH_L_TRANSFORM"
data "StackType" "Overwrite"
data "StackPriority" "30"

//Visual part
//-----------------------------------------------------------------------------------------------------------------------------------------
new entry "PATHOFUNDEATH_L_TRANSFORM_TICK"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "habeec62bgb04dg471fg94c4gf45f61be809e;1"
data "Description" "h22100c4dge6e0g4e1dgb48eg4cc6b7cdcf69;1"
data "StackType" "Ignore"
data "OnApplyRoll" "SavingThrow(Ability.Wisdom,25)"
data "OnApplySuccess" "SetStatusDuration(PATHOFUNDEATH_L_RITUAL,-1,Add)"
//data "OnApplyFail" "IF(HasStatus('DREADOVERLORD_SOULSHIELD')):ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_TICK_SOUL,100,0)"
data "OnApplyFunctors" "IF(not StatusDurationLessThan(context.Source,'PATHOFUNDEATH_L_RITUAL',10)):ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_CIRCLE,100,-1);IF(StatusDurationLessThan(context.Source,'PATHOFUNDEATH_L_RITUAL',10) and not StatusDurationLessThan(context.Source,'PATHOFUNDEATH_L_RITUAL',8)):ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_CIRCLE_2,100,-1);IF(StatusDurationLessThan(context.Source,'PATHOFUNDEATH_L_RITUAL',8) and not StatusDurationLessThan(context.Source,'PATHOFUNDEATH_L_RITUAL',6)):ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_CIRCLE_3,100,-1);IF(StatusDurationLessThan(context.Source,'PATHOFUNDEATH_L_RITUAL',6) and not StatusDurationLessThan(context.Source,'PATHOFUNDEATH_L_RITUAL',4)):ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_CIRCLE_4,100,-1);IF(StatusDurationLessThan(context.Source,'PATHOFUNDEATH_L_RITUAL',4) and not StatusDurationLessThan(context.Source,'PATHOFUNDEATH_L_RITUAL',2)):ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_CIRCLE_5,100,-1);"
data "ApplyEffect" "54420b48-840e-49f3-a458-f524a4efaffa"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

//new entry "PATHOFUNDEATH_L_TRANSFORM_TICK_SOUL"
//type "StatusData"
//data "StatusType" "BOOST"
//data "OnApplyFunctors" "SetStatusDuration(DREADOVERLORD_SOUSHIELD,-1,Add);SetStatusDuration(PATHOFUNDEATH_L_RITUAL,-1,Add)"
//data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "PATHOFUNDEATH_L_TRANSFORM_VFX"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "StatusEffect" "695c1093-a0be-4575-89e1-995388faf747"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_L_RITUAL')"
data "OnApplyFunctors" "ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_VFX_2,100,-1);ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_CIRCLE,100,-1);ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_BLUR,100,-1)"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "PATHOFUNDEATH_L_TRANSFORM_VFX_2"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_TRANSFORM_VFX"
data "StatusEffect" "eeaa069d-2a6a-418a-a119-69e86211058a"
data "OnApplyFunctors" ""

new entry "PATHOFUNDEATH_L_TRANSFORM_CIRCLE"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_TRANSFORM_CIRCLE"
data "StackPriority" "10"
data "StackType" "Ignore"
data "StatusEffect" "cc9ae800-7cf8-495f-9c2e-22f765c1e737"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "PATHOFUNDEATH_L_TRANSFORM_CIRCLE_2"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_TRANSFORM_CIRCLE"
data "StackPriority" "20"
data "StatusEffect" "4820635c-82b3-4e71-833e-5878bd277835"

new entry "PATHOFUNDEATH_L_TRANSFORM_CIRCLE_3"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_TRANSFORM_CIRCLE"
data "StackPriority" "30"
data "StatusEffect" "4e57c242-72bf-49ed-9f94-470568092bf1"

new entry "PATHOFUNDEATH_L_TRANSFORM_CIRCLE_4"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_TRANSFORM_CIRCLE"
data "StackPriority" "40"
data "StatusEffect" "79447eb2-0c9f-41f5-b97e-12f4c1ae2437"

new entry "PATHOFUNDEATH_L_TRANSFORM_CIRCLE_5"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_TRANSFORM_CIRCLE"
data "StackPriority" "50"
data "StatusEffect" "e5ace984-93e2-4747-9c9d-194045e9e2e4"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_L_RITUAL')"
data "OnRemoveFunctors" "ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_END,100,0)"

new entry "PATHOFUNDEATH_L_TRANSFORM_END"
type "StatusData"
data "StatusType" "BOOST"
data "StatusEffect" "69f0508d-7864-4da3-a8cf-d31b6264278c"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "PATHOFUNDEATH_L_TRANSFORM_BLUR"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_TRANSFORM_VFX_2"
data "StatusEffect" "41cfa525-93f3-4a8a-8522-8d3320c028ab"
data "RemoveEvents" "OnStatusApplied"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_LICHDOM')"

new entry "PATHOFUNDEATH_L_TRANSFORM_HELL"
type "StatusData"
data "StatusType" "BOOST"
data "StatusEffect" "39af7da2-da9e-4aea-a702-913cf3447390"
data "OnRemoveFunctors" "Kill();ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_KILL,100,0)"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "PATHOFUNDEATH_L_TRANSFORM_FAILED"
type "StatusData"
data "StatusType" "BOOST"
data "Boosts" "Tag(BLOCK_RESURRECTION)"
data "StatusPropertyFlags" "IgnoreResting;ApplyToDead;DisableCombatlog;DisableOverhead;DisablePortraitIndicator"
data "OnApplyFunctors" "ApplyStatus(PATHOFUNDEATH_L_TRANSFORM_HELL,100,1)"

new entry "PATHOFUNDEATH_L_TRANSFORM_DISINTEGRATE"
type "StatusData"
data "StatusType" "BOOST"
//data "ApplyEffect" "50cd698d-45fa-488d-9bef-37790575ddd2"
data "OnRemoveFunctors" "IF(RemoveCause(StatusRemoveCause.Death)):SwitchDeathType(Disintegrate)"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "PATHOFUNDEATH_L_TRANSFORM_KILL"
type "StatusData"
data "StatusType" "BOOST"
data "ApplyEffect" "f58b6b6e-0403-4078-9c72-ccf06632bcf0"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead"



//-----------------------------------------------------------------------------------------------------------------------------------------
//Lichdom
//-----------------------------------------------------------------------------------------------------------------------------------------
new entry "PATHOFUNDEATH_LICHDOM"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hf93a4887gde85g4ea8g8801g4174d36fca10;1"
data "Description" "h16edca6346a24f968a42bb744c9cda2a74c4;1"
data "Icon" "PoU_4_Lichdom"
data "StackId" "PATHOFUNDEATH_UNDEATH"
data "StackType" "Ignore"
data "StackPriority" "40"
data "Passives" "PathOfUndeath_U_Defiler;PathOfUndeath_U_Defiler_Dread;PathOfUndeath_U_Defiler_Dread_2;PathOfUndeath_ShortResting;PathOfUndeath_Vampirism;PathOfUndeath_V_Specials;PathOfUndeath_GreaterUndeath;GraveMagic;ImmuneToControlUndead;PathOfUndeath_Lichdom;PathOfUndeath_L_IPO_Buff_Giver;PathOfUndeath_L_HalfIllithid;PathOfUndeath_L_Illithid;PathOfUndeath_G_Control"
data "OnApplyFunctors" "ApplyStatus(PATHOFUNDEATH_PHYLACTERY_UP,100,-1);RemoveStatus(PATHOFUNDEATH_G_RADIANT_VULN);RemoveStatus(PATHOFUNDEATH_G_FIREACID_VULN);RemoveStatus(PATHOFUNDEATH_G_CELESTIAL);RemoveStatus(PATHOFUNDEATH_G_INURED);RemoveStatus(PATHOFUNDEATH_G_REBORN);ApplyStatus(PATHOFUNDEATH_L_VFX,100,-1);ApplyStatus(PATHOFUNDEATH_VAMPIRISM_PERMANENT,100,-1)"
data "TickFunctors" "ApplyStatus(PATHOFUNDEATH_VAMPIRISM_PERMANENT,100,-1)"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "Boosts" "UnlockSpellVariant(SpellId('PathOfUndeath_V_Enthrall'),ModifyTargetRadius(Override,6),ModifyTooltipDescription())"

//Gives powers depending to the character
new entry "PathOfUndeath_Lichdom"
type "PassiveData"
data "DisplayName" "hf93a4887gde85g4ea8g8801g4174d36fca10;1"
data "Description" "h6aa86d04gc094g4cdcg9ac4gf6f7c6de3f6b;1"
data "Icon" "PoU_4_Lichdom"
data "Properties" "Highlighted"
data "StatsFunctorContext" "OnEquip;OnCreate;OnStatusApplied;OnStatusRemoved"
data "StatsFunctors" "IF(HasPassive('Aasimar_Fallen_Resistance') & ~HasStatus('PATHOFUNDEATH_PHYLACTERY_DOWN')):ApplyStatus(PATHOFUNDEATH_L_RADIANT_RES,100,-1);IF(HasPassive('Aasimar_Fallen_Resistance') & HasStatus('PATHOFUNDEATH_PHYLACTERY_DOWN')):ApplyStatus(PATHOFUNDEATH_L_RADIANT_NEUTRAL,100,-1);IF(~HasPassive('Aasimar_Fallen_Resistance') & HasStatus('PATHOFUNDEATH_PHYLACTERY_DOWN') ):ApplyStatus(PATHOFUNDEATH_L_RADIANT_VULN,100,-1);IF(~HasPassive('Aasimar_Fallen_Resistance') & ~HasStatus('PATHOFUNDEATH_PHYLACTERY_DOWN') ):ApplyStatus(PATHOFUNDEATH_L_RADIANT_NEUTRAL_2,100,-1);IF(~HasPassive('LODPassive_DeathlessFeature') & HasPassive('InuredtoUndeath') & ~HasStatus('PATHOFUNDEATH_PHYLACTERY_DOWN')):ApplyStatus(PATHOFUNDEATH_L_FIREACID_RES,100,-1);IF(~HasPassive('LODPassive_DeathlessFeature') & HasPassive('InuredtoUndeath') & HasStatus('PATHOFUNDEATH_PHYLACTERY_DOWN')):ApplyStatus(PATHOFUNDEATH_L_FIREACID_NEUTRAL,100,-1);IF(~HasPassive('LODPassive_DeathlessFeature') & ~HasPassive('InuredtoUndeath') & HasStatus('PATHOFUNDEATH_PHYLACTERY_DOWN')):ApplyStatus(PATHOFUNDEATH_L_FIREACID_VULN,100,-1);IF(~HasPassive('LODPassive_DeathlessFeature') & ~HasPassive('InuredtoUndeath') & ~HasStatus('PATHOFUNDEATH_PHYLACTERY_DOWN')):ApplyStatus(PATHOFUNDEATH_L_FIREACID_NEUTRAL_2,100,-1);IF(HasPassive('DreadOverlord_UnholyVigor')):ApplyStatus(PATHOFUNDEATH_L_UNHOLYVIGOR,100,-1);IF(HasPassive('Background_HauntedOne') or HasPassive('LODHauntedOne_Enigma')):ApplyStatus(PATHOFUNDEATH_L_DURGE,100,-1);IF(HasPassive('LODPassive_DeathlessFeature') & HasPassive('InuredtoUndeath') & ~HasStatus('PATHOFUNDEATH_PHYLACTERY_DOWN')):ApplyStatus(PATHOFUNDEATH_L_REBORN_IMM,100,-1);IF(HasPassive('LODPassive_DeathlessFeature') & HasPassive('InuredtoUndeath') & HasStatus('PATHOFUNDEATH_PHYLACTERY_DOWN')):ApplyStatus(PATHOFUNDEATH_L_REBORN_RES,100,-1);IF(HasPassive('LODPassive_DeathlessFeature') & ~HasPassive('InuredtoUndeath') & HasStatus('PATHOFUNDEATH_PHYLACTERY_DOWN')):ApplyStatus(PATHOFUNDEATH_L_REBORN_NEUTRAL,100,-1);IF(HasPassive('LODPassive_DeathlessFeature') & ~HasPassive('InuredtoUndeath') & ~HasStatus('PATHOFUNDEATH_PHYLACTERY_DOWN')):ApplyStatus(PATHOFUNDEATH_L_REBORN_RES_2,100,-1)"
data "Boosts" "SpellSaveDC(3)"

//Phylactery up
//Radiant
new entry "PATHOFUNDEATH_L_RADIANT_NEUTRAL_2"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_RADIANT"
data "StackType" "Ignore"
data "StackPriority" "20"
data "Passives" "PathOfUndeath_Lichdom_Radiant_Neutral_2"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_PHYLACTERY_DOWNED')"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"

new entry "PathOfUndeath_Lichdom_Radiant_Neutral_2"
type "PassiveData"
data "DisplayName" "hef8f1bd1g04a7g48c7gbef7g4fc923b30e52;1"
data "Description" "h77b93943gf017g43f4gb655g57a2692f7e39;1"
data "Icon" "PoU_4_RadiantNeutral2"
data "Properties" "Highlighted"

//Phylactery down
//Radiant
new entry "PATHOFUNDEATH_L_RADIANT_VULN"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_RADIANT"
data "StackType" "Ignore"
data "StackPriority" "30"
data "Passives" "PathOfUndeath_Lichdom_Radiant_Vuln"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_PHYLACTERY_DOWN')"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"

new entry "PathOfUndeath_Lichdom_Radiant_Vuln"
type "PassiveData"
data "DisplayName" "h3e1d9184gaf2bg4650g8cf4gec4e82965215;1"
data "Description" "hbbdd2192g7678g4652g9481ge36fd3687874;1"
data "Icon" "PoU_4_RadiantWeakness"
data "Properties" "Highlighted"
data "Boosts" "Resistance(Radiant, Vulnerable)"

//Phylactery up
//Fire & Acid
new entry "PATHOFUNDEATH_L_FIREACID_NEUTRAL_2"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_FIREACID"
data "StackType" "Ignore"
data "StackPriority" "20"
data "Passives" "PathOfUndeath_Lichdom_FireAcid_Neutral_2"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_PHYLACTERY_UP')"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"

new entry "PathOfUndeath_Lichdom_FireAcid_Neutral_2"
type "PassiveData"
data "DisplayName" "hc3266bd9f6534162a6705fecefdfe0d46e3f;1"
data "Description" "h2bd52c43g2acdg491eg9841g3370fec4d41f;1"
data "Icon" "PoU_4_FireAcidNeutral2"
data "Properties" "Highlighted"

//Phylactery down
//Fire & Acid
new entry "PATHOFUNDEATH_L_FIREACID_VULN"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_FIREACID"
data "StackType" "Ignore"
data "StackPriority" "30"
data "Passives" "PathOfUndeath_Lichdom_FireAcid_Vuln"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_PHYLACTERY_DOWN')"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"

new entry "PathOfUndeath_Lichdom_FireAcid_Vuln"
type "PassiveData"
data "DisplayName" "h0b9f9cbc8b6845a0bd3f962bb39db1974922;1"
data "Description" "hd6968256ge938g4e93g9a5eg343504b64b6c;1"
data "Icon" "PoU_4_FireAcidWeakness"
data "Properties" "Highlighted"
data "Boosts" "Resistance(Fire, Vulnerable);Resistance(Acid, Vulnerable)"

//Phylactery up
//Makes you survive being downed or killed
new entry "PATHOFUNDEATH_PHYLACTERY_UP"
type "StatusData"
data "StatusType" "BOOST"
using "DEATH_WARD"
data "DisplayName" "hbc4a0672g1ef7g4a98g92a7g8311de0e5233;1"
data "Description" "hafd9c1eag5c4eg4776ga5eeg2ef10cbe73fc;1"
data "Icon" "PoU_4_PhylacteryUp"
data "StackId" "PATHOFUNDEATH_PHYLACTERY"
data "StackPriority" "10"
data "StackType" "Ignore"
data "Boosts" "DownedStatus(PATHOFUNDEATH_PHYLACTERY_DOWNED,1)"
data "Passives" "MagicResistance;PathOfUndeath_L_BleedingImmunity;PathOfUndeath_L_DurgeCheck"
data "StatusPropertyFlags" "DisableOverhead;IgnoreResting"
data "OnRemoveFunctors" "IF(RemoveCause(StatusRemoveCause.Death)):ApplyStatus(PATHOFUNDEATH_L_RESURRECT,100,1)"
data "StatusEffect" ""
data "OnApplyFunctors" "ApplyStatus(PATHOFUNDEATH_L_VFX,100,-1);IF(Tagged('Blackguard')):ApplyStatus(PATHOFUNDEATH_PHYLACTERY_UP_PASSIVES_BG,100,-1);IF(not Tagged('Blackguard')):ApplyStatus(PATHOFUNDEATH_PHYLACTERY_UP_PASSIVES_REG,100,-1)"

new entry "PATHOFUNDEATH_PHYLACTERY_DOWNED"
type "StatusData"
data "StatusType" "DOWNED"
using "DEATH_WARD_DOWNED"
data "OnApplyFunctors" "ApplyStatus(PATHOFUNDEATH_PHYLACTERY_DOWN,100,-1);RegainHitPoints(MaxHP,Guaranteed)"

new entry "PATHOFUNDEATH_L_RESURRECT"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_RESURRECT"
data "StackType" "Ignore"
data "StackPriority" "10"
data "DisplayName" "hbc4a0672g1ef7g4a98g92a7g8311de0e5233;1"
data "Description" "hafd9c1eag5c4eg4776ga5eeg2ef10cbe73fc;1"
data "Icon" "PoU_4_PhylacteryUp"
data "OnRemoveFunctors" "Resurrect(100,100);ApplyStatus(PATHOFUNDEATH_PHYLACTERY_DOWN,100,-1)"
data "StatusPropertyFlags" "IgnoreResting;ApplyToDead"

//Status immunities
new entry "PATHOFUNDEATH_PHYLACTERY_UP_PASSIVES_REG"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "Passives" "PathOfUndeath_L_StatusImmunities"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_PHYLACTERY_UP')"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

new entry "PATHOFUNDEATH_PHYLACTERY_UP_PASSIVES_BG"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "Passives" "PathOfUndeath_L_StatusImmunities_BG"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_PHYLACTERY_UP')"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

new entry "PathOfUndeath_L_StatusImmunities"
type "PassiveData"
data "DisplayName" "h2b177e8bgf1c4g4684g93ecg32e101f50a1d;1"
data "Description" "h33f269cfgb631g4793g80faga04c77ff7857;1"
data "Icon" "PoU_4_StatusImmunity"
data "Properties" "Highlighted"
data "Boosts" "StatusImmunity(SG_Cursed);StatusImmunity(SILENCED);Resistance(Slashing,ResistantToNonMagical);Resistance(Piercing,ResistantToNonMagical);Resistance(Bludgeoning,ResistantToNonMagical)"

new entry "PathOfUndeath_L_StatusImmunities_BG"
type "PassiveData"
data "DisplayName" "h2b177e8bgf1c4g4684g93ecg32e101f50a1d;1"
data "Description" "h5de8fddf6c8a4a51a757ef5a2146fcb371g0;1"
data "Icon" "PoU_4_StatusImmunity"
data "Properties" "Highlighted"
data "Boosts" "StatusImmunity(SG_Cursed);StatusImmunity(SILENCED);Resistance(Slashing,ImmuneToNonMagical);Resistance(Piercing,ImmuneToNonMagical);Resistance(Bludgeoning,ImmuneToNonMagical)"

new entry "PathOfUndeath_L_BleedingImmunity"
type "PassiveData"
data "DisplayName" "hbf38c2dc33504e9aac73811c6b170fdb7242;1"
data "Description" "h180459e4252d42df8e90262e91504899db47;1"
data "Icon" "PoU_4_StatusImmunity"
data "Properties" "IsToggled;ToggledDefaultOn"
data "Boosts" "StatusImmunity(BLEEDING)"

//Phylactery down
//Revival off
//Also makes "Dark Rite - Replenish Phylactery" ignore resistance/immunity
new entry "PATHOFUNDEATH_PHYLACTERY_DOWN"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hf6c65d6dg2c5dg4e20ga776g9bf619103c62;1"
data "Description" "h2ce88a38g68ebg40d2g96cdgd1f562245809;1"
data "StatusPropertyFlags" "ApplyToDead"
data "Icon" "PoU_4_PhylacteryDown"
data "StackId" "PATHOFUNDEATH_PHYLACTERY"
data "StackPriority" "20"
data "StackType" "Ignore"
data "StatusPropertyFlags" "ApplyToDead"
data "Passives" "PathOfUndeath_L_StatusImmunities_No"
data "OnRemoveFunctors" "IF(not RemoveCause(StatusRemoveCause.Death)):ApplyStatus(PATHOFUNDEATH_PHYLACTERY_UP,100,-1)"
data "Boosts" "UnlockSpell(PathOfUndeath_Replenish)"
data "OnApplyFunctors" "RemoveStatus(PATHOFUNDEATH_PHYLACTERY_UP);RemoveStatus(PATHOFUNDEATH_L_VFX)"

//Status immunities disabled
new entry "PathOfUndeath_L_StatusImmunities_No"
type "PassiveData"
data "DisplayName" "ha3bb35b2g5878g4a92g8692gba45bf1739ca;1"
data "Description" "he860db05g5c0dg4d61g824bg1d15587f9527;1"
data "Icon" "PoU_4_StatusNoImmunity"
data "Properties" "Highlighted"



//-------------------------------------------------------------------------------------------------------------------------------------
//Fallen Aasimar
//-------------------------------------------------------------------------------------------------------------------------------------
//Aasimar phylactery up
new entry "PATHOFUNDEATH_L_RADIANT_RES"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_RADIANT"
data "StackType" "Ignore"
data "StackPriority" "10"
data "Passives" "PathOfUndeath_Lichdom_Radiant_Res"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_PHYLACTERY_UP')"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"

new entry "PathOfUndeath_Lichdom_Radiant_Res"
type "PassiveData"
data "DisplayName" "hf8245363ge2d0g495ag9471ge275fce60604;1"
data "Description" "hb791e460g543ag481eg876dg84bf84cb02dd;1"
data "Icon" "PoU_4_RadiantResistance"
data "Properties" "Highlighted"
data "Boosts" "Resistance(Radiant, Resistant)"

//Aasimar phylactery down
new entry "PATHOFUNDEATH_L_RADIANT_NEUTRAL"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_RADIANT"
data "StackType" "Ignore"
data "StackPriority" "20"
data "Passives" "PathOfUndeath_Lichdom_Radiant_Neutral"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_PHYLACTERY_DOWN')"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"

new entry "PathOfUndeath_Lichdom_Radiant_Neutral"
type "PassiveData"
data "DisplayName" "h26e4c0abg3105g4189g85d4g02cf2d3f8ed2;1"
data "Description" "hbe54c7c8ge6a5g4688gb476g1c5b93b54151;1"
data "Icon" "PoU_4_RadiantNeutral"
data "Properties" "Highlighted"


//-------------------------------------------------------------------------------------------------------------------------------------
//Inured to Undeath
//-------------------------------------------------------------------------------------------------------------------------------------
//Inured phylactery up
new entry "PATHOFUNDEATH_L_FIREACID_RES"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_FIREACID"
data "StackType" "Ignore"
data "StackPriority" "30"
data "Passives" "PathOfUndeath_Lichdom_FireAcid_Res"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_PHYLACTERY_UP') or not HasPassive('InuredtoUndeath')"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"

new entry "PathOfUndeath_Lichdom_FireAcid_Res"
type "PassiveData"
data "DisplayName" "h9a959ddagdfcag4644ga648g41d09d35c1dc;1"
data "Description" "hf5132e16gbab9g4df6gb519g267c43d0b25f;1"
data "Icon" "PoU_4_FireAcidResistance"
data "Properties" "Highlighted"
data "Boosts" "Resistance(Fire, Resistant);Resistance(Acid, Resistant)"

//Inured phylactery down
new entry "PATHOFUNDEATH_L_FIREACID_NEUTRAL"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_FIREACID"
data "StackType" "Ignore"
data "StackPriority" "40"
data "Passives" "PathOfUndeath_Lichdom_FireAcid_Neutral"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_PHYLACTERY_DOWN') or not HasPassive('InuredtoUndeath')"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"

new entry "PathOfUndeath_Lichdom_FireAcid_Neutral"
type "PassiveData"
data "DisplayName" "hde8cd20ag11aag4cc1ga231g6f39b7fde242;1"
data "Description" "hddaba443g86f3g4e1fg95ccgdff062237469;1"
data "Icon" "PoU_4_FireAcidNeutral"
data "Properties" "Highlighted"



//-------------------------------------------------------------------------------------------------------------------------------------
//Reborn
//-------------------------------------------------------------------------------------------------------------------------------------
//Reborn phylactery up
new entry "PATHOFUNDEATH_L_REBORN_RES_2"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_FIREACID"
data "StackType" "Ignore"
data "StackPriority" "10"
data "Passives" "PathOfUndeath_Lichdom_Reborn_Res2"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_PHYLACTERY_UP')"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"

//todo: icon
new entry "PathOfUndeath_Lichdom_Reborn_Res2"
type "PassiveData"
data "DisplayName" "hf08fd6c1g5728g44b6g90fdg89428e523e11;1"
data "Description" "h0abc1904g55c4g4a3eg8f24g2b0db5910ef8;1"
data "Icon" "LOD_P_DeathlessNature"
data "Properties" "Highlighted"

//Reborn phylactery down
new entry "PATHOFUNDEATH_L_REBORN_NEUTRAL"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_FIREACID"
data "StackType" "Ignore"
data "StackPriority" "20"
data "Passives" "PathOfUndeath_Lichdom_Reborn_Neutral"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_PHYLACTERY_DOWN')"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"

//todo: icon
new entry "PathOfUndeath_Lichdom_Reborn_Neutral"
type "PassiveData"
data "DisplayName" "h680b644agc00ag4063gb670g86174646db3a;1"
data "Description" "hd08cf72bg809cg4cbcga4cbgd8b69a7ec2d0;1"
data "Icon" "LOD_P_DeathlessNature"
data "Properties" "Highlighted"
data "Boosts" "Resistance(Fire, Vulnerable)"


//-------------------------------------------------------------------------------------------------------------------------------------
//Reborn + Inured
//-------------------------------------------------------------------------------------------------------------------------------------
//Reborn phylactery up
new entry "PATHOFUNDEATH_L_REBORN_IMM"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_FIREACID"
data "StackType" "Ignore"
data "StackPriority" "10"
data "Passives" "PathOfUndeath_Lichdom_Reborn_Imm"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_PHYLACTERY_UP')"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"

//todo: icon
new entry "PathOfUndeath_Lichdom_Reborn_Imm"
type "PassiveData"
data "DisplayName" "h286d6552g46b9g4c5egafe4gbddb00cb1666;1"
data "Description" "h8530127eg314fg4d12g9ba8g6db90204a20c;1"
data "Icon" "LOD_P_DeathlessNature"
data "Properties" "Highlighted"
data "Boosts" "Resistance(Fire, Resistant);Resistance(Acid, Immune)"

//Reborn phylactery down
new entry "PATHOFUNDEATH_L_REBORN_RES"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_FIREACID"
data "StackType" "Ignore"
data "StackPriority" "20"
data "Passives" "PathOfUndeath_Lichdom_Reborn_Res"
data "RemoveEvents" "OnStatusRemoved"
data "RemoveConditions" "StatusId('PATHOFUNDEATH_PHYLACTERY_DOWN')"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"

//todo: icon
new entry "PathOfUndeath_Lichdom_Reborn_Res"
type "PassiveData"
data "DisplayName" "h92b9b477g2234g4db5g8815gd1b1e07e64f2;1"
data "Description" "h6c65d871ga43cg4f72g91dbgc85778075d54;1"
data "Icon" "LOD_P_DeathlessNature"
data "Properties" "Highlighted"



//-------------------------------------------------------------------------------------------------------------------------------------
//Lich spells
//-------------------------------------------------------------------------------------------------------------------------------------
//Oblivionize

//Phlegethian Emberstone
//Gives Oblivionize spell + Hellfire Malevolence passive
new entry "PoU_Emberstone"
type "Object"
using "OBJ_Indestructible_Tiny"
data "StatusInInventory" "PATHOFUNDEATH_EMBERSTONE_INV"

new entry "PATHOFUNDEATH_EMBERSTONE"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "AuraRadius" "1"
data "AuraStatuses" "ApplyStatus(BURNING,100,1)"
data "StatusEffect" "2a310006-c2bb-497f-b2a2-6fe94c6f9007"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

//Technical status
new entry "PATHOFUNDEATH_EMBERSTONE_INV"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "ApplyEffect" "a8337d73-c4d0-445a-bbeb-31405fa4016f"
data "Boosts" "IF(HasPassive('PathOfUndeath_Thayan',context.Source)):UnlockSpell(PathOfUndeath_Oblivionize,AddChildren,77fcde9b-9cda-4fbc-8806-393e26b2f3e1);IF(HasPassive('PathOfUndeath_Thayan',context.Source)):ActionResource(ShadowSpellSlot,1,6)"
data "Passives" "PathOfUndeath_Hellfire;PathOfUndeath_Hellpyre"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"
data "OnRemoveFunctors" "RemoveStatus(AZARDON_EMBER_TOGGLE);RemoveStatus(AZARDON_EMBER_TOGGLED)"

//Burns with Hellfire (irresistible)
new entry "PathOfUndeath_Oblivionize"
type "SpellData"
data "SpellType" "Target"
data "Level" "9"
data "SpellSchool" "Necromancy"
data "TargetRadius" "9"
data "DeathType" "Disintegrate"
data "TargetConditions" "Character() and not Self() and not Dead()"
data "DisplayName" "hbc5571a1g0052g4147gb2d0g26dfdafe5d7d;1"
data "Description" "h74b70f4fg76ceg48c0gbbddgac7c892d86dd;1"
data "DescriptionParams" "DealDamage(12d6,Fire)"
data "TooltipDamageList" "DealDamage(12d6,Fire)"
data "TooltipStatusApply" "ApplyStatus(PATHOFUNDEATH_HELLFIRE,100,3)"
data "TooltipAttackSave" "Dexterity"
data "TooltipOnSave" "f762efbb-f8f1-493e-b248-2de1567b4bd2"
data "TooltipPermanentWarnings" "0695feaa-7a95-4216-a292-c0eef5b5c3d0"
data "Icon" "PoU_4_Oblivionize"
data "PrepareSound" "Action_Prepare_Item_HellCrawler"
data "PrepareLoopSound" "Action_Loop_Item_HellCrawler"
data "CastSound" "Action_Cast_Item_ImmolatingGaze"
data "TargetSound" "Action_Impact_Item_ImmolatingGaze"
data "CastTextEvent" "Cast"
data "SpellRoll" "not SavingThrow(Ability.Dexterity, SourceSpellDC(),false,true)"
data "SpellSuccess" "DealDamage(12d6,Fire,Magical,,0,,,,,true)"
data "SpellFail" "DealDamage((12d6)/2,Fire,Magical,,0,,,,,true)"
data "UseCosts" "ActionPoint:1;ShadowSpellSlot:1:1:6"
data "SpellProperties" "GROUND:SurfaceChange(Ignite);SurfaceChange(Ignite);GROUND:SurfaceChange(Melt);IF(Enemy()):ApplyStatus(PATHOFUNDEATH_HELLFIRE,100,2);IF(HasStatus('PATHOFUNDEATH_MORTISURGE_FOE')):SpawnExtraProjectiles(PathOfUndeath_OblivionProjectile);IF(HasStatus('PATHOFUNDEATH_SPELLPLAGUE')):ApplyStatus(PATHOFUNDEATH_OBLIVIONIZE_WEAVEWANED,100,1);RemoveStatus(PATHOFUNDEATH_UNHOLYCHALLENGER_ARMOR)"
data "SpellAnimation" "f94542d9-a79c-478a-92de-573cead9260e,,;,,;821615de-23e4-4022-b8aa-b7977b071329,,;5a0d43d4-0aa3-4419-a44d-b40889925196,,;bd339475-d2b5-46e8-8d0c-9f2ad6a91328,,;,,;7a28f440-1b0b-4a18-96a8-3767959b601a,,;,,;,,"
data "PrepareEffect" "7efd7809-4a4a-4689-9ecb-65e49518a79d"
data "CastEffect" "ccbb436e-cc35-41e6-9076-99534f7b4d81"
data "TargetEffect" "32111bfc-925e-4e95-9f31-cddc211619fd"
data "BeamEffect" "a76e1745-fca0-46fd-b93b-ac4abc37a598"
data "VerbalIntent" "Damage"
data "SpellFlags" "HasVerbalComponent;HasSomaticComponent;IsHarmful;IsSpell;HasHighGroundRangeExtension"
data "DamageType" "Fire"

//Custom Hellfire Burn
//Deals full (true) irrestible damage while in Hellfire
//Deals half the damage while not in Hellfire
//Lasts 1 more turn if turn started in Hellfire, starts at 2
new entry "PATHOFUNDEATH_HELLFIRE"
type "StatusData"
data "StatusType" "BOOST"
using "BURNING_HELLFIRE"
data "DisplayName" "h224b7911g4371g4fa0gbd63g80257aa74ca2;2"
data "Description" "h99088ba5g3bf2g4379g86d0g4f4c1d786d15;1"
data "DescriptionParams" "DealDamage(6d6,Fire)"
data "StackPriority" "2"
data "TickFunctors" "IF(InSurface('SurfaceHellfire') or HasStatus('PATHOFUNDEATH_SPELLPLAGUE')):SetStatusDuration(PATHOFUNDEATH_HELLFIRE,1,Add);IF(InSurface('SurfaceHellfire')):DealDamage(6d6,Fire,Magical,,0,,true,,,true);IF(not InSurface('SurfaceHellfire')):DealDamage(3d6,Fire,Magical,,0,,true,,,true)"
data "OnApplyFunctors" "DealDamage(6d6,Fire,Magical,,0,,true,,,true)"
data "StatusEffect" "414eaed3-92e0-40a5-97c0-13768513a753"
data "OnRemoveFunctors" "IF(InSurface('SurfaceHellfire')):ApplyStatus(PATHOFUNDEATH_HELLFIRE,100,1)"
data "TooltipPermanentWarnings" "0695feaa-7a95-4216-a292-c0eef5b5c3d0"

//Hidden passive to spwan Hellfire surface proportional to target size
new entry "PathOfUndeath_Hellpyre"
type "PassiveData"
data "StatsFunctorContext" "OnAttack"
data "Conditions" "SpellId('PathOfUndeath_Oblivionize') or SpellId('PathOfUndeath_OblivionProjectile')"
data "StatsFunctors" "GROUND:IF(TargetSizeEqualOrSmaller(Size.Tiny)):CreateSurface(0.5,3,Hellfire);GROUND:IF(not TargetSizeEqualOrSmaller(Size.Tiny) and TargetSizeEqualOrSmaller(Size.Small)):CreateSurface(1,3,Hellfire);GROUND:IF(not TargetSizeEqualOrSmaller(Size.Small) and TargetSizeEqualOrSmaller(Size.Medium)):CreateSurface(1.5,3,Hellfire);GROUND:IF(not TargetSizeEqualOrSmaller(Size.Medium) and TargetSizeEqualOrSmaller(Size.Large)):CreateSurface(3,3,Hellfire);GROUND:IF(not TargetSizeEqualOrSmaller(Size.Large) and TargetSizeEqualOrSmaller(Size.Huge)):CreateSurface(6,3,Hellfire);"
data "Properties" "IsHidden"

//Chain projectile
new entry "PathOfUndeath_OblivionProjectile"
type "SpellData"
using "PathOfUndeath_Oblivionize"
data "SpellType" "Projectile"
data "TargetRadius" "50"
data "ProjectileCount" "1"
data "Trajectories" "c425e84e-3e3f-4b8c-9ae9-e314246e3fe3"
data "TargetConditions" "not Dead() and Enemy() and HasStatus('PATHOFUNDEATH_MORTISURGE_FOE')"

//Hellfire Malevolence
new entry "PathOfUndeath_Hellfire"
type "PassiveData"
data "DisplayName" "hb9494717g7c56g44cag9aefgc8f004c7d6f4;1"
data "Description" "h51bfe589gd3fbg4061gb611g917ab0d1003f;1"
data "Icon" "PoU_4_HellfireMalevolence"
data "Properties" "IsToggled;ToggledDefaultAddToHotbar;ToggledDefaultOn"
data "DescriptionParams" "DealDamage(1d6,Fire)"
data "StatsFunctorContext" "OnAttack"
data "Conditions" "not IsMiss() and not IsCriticalMiss() and not Ally()"
data "StatsFunctors" "DealDamage(1d6,Fire,Magical,,0,,true,,,true)"
data "ToggleOnFunctors" "ApplyStatus(PATHOFUNDEATH_HELLFIRE_TECHNICAL,100,-1)"
data "ToggleOffFunctors" "RemoveStatus(PATHOFUNDEATH_HELLFIRE_TECHNICAL);RemoveStatus(PATHOFUNDEATH_HELLFIRE_VFX)"
data "TooltipPermanentWarnings" "0695feaa-7a95-4216-a292-c0eef5b5c3d0"

new entry "PATHOFUNDEATH_HELLFIRE_TECHNICAL"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "Passives" "PathOfUndeath_Hellfire_VFX"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

new entry "PathOfUndeath_Hellfire_VFX"
type "PassiveData"
data "StatsFunctorContext" "OnCreate;OnCombatStarted"
data "StatsFunctors" "IF(Combat()):ApplyStatus(PATHOFUNDEATH_HELLFIRE_VFX,100,-1)"
data "Properties" "IsHidden" 

new entry "PATHOFUNDEATH_HELLFIRE_VFX"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "StatusEffect" "9ec00292-4485-4462-8360-0aeb6dd5e6cf"
data "RemoveEvents" "OnCombatEnded"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

new entry "PATHOFUNDEATH_OBLIVIONIZE_WEAVEWANED"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Overwrite"
data "OnApplyFunctors" "IF(HasActionResource('SpellSlot',1,6,false)):ApplyStatus(PATHOFUNDEATH_ANTIMAGIC_6,100,0);IF(not HasActionResource('SpellSlot',1,6,false) and HasActionResource('SpellSlot',1,5,false)):ApplyStatus(PATHOFUNDEATH_ANTIMAGIC_5,100,0);IF(not HasActionResource('SpellSlot',1,5,false) and HasActionResource('SpellSlot',1,4,false)):ApplyStatus(PATHOFUNDEATH_ANTIMAGIC_4,100,0);IF(not HasActionResource('SpellSlot',1,4,false) and HasActionResource('SpellSlot',1,3,false)):ApplyStatus(PATHOFUNDEATH_ANTIMAGIC_3,100,0);IF(not HasActionResource('SpellSlot',1,3,false) and HasActionResource('SpellSlot',1,2,false)):ApplyStatus(PATHOFUNDEATH_ANTIMAGIC_2,100,0);IF(not HasActionResource('SpellSlot',1,2,false) and HasActionResource('SpellSlot',1,1,false)):ApplyStatus(PATHOFUNDEATH_ANTIMAGIC_1,100,0)"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"



//-------------------------------------------------------------------------------------------------------------------------------------
//Abyssal Heartstone
//Gives Mortisurge spell + Unlife Pulse passive
new entry "PoU_Heartstone"
type "Object"
using "OBJ_Indestructible_Tiny"
data "StatusInInventory" "PATHOFUNDEATH_HEARTSTONE_INV"

//Stone's vfx when on the ground
new entry "PATHOFUNDEATH_HEARTSTONE"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "StatusEffect" "264e6146-f00f-46cd-b6c8-131a065afae8"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting"

//Technical status
new entry "PATHOFUNDEATH_HEARTSTONE_INV"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "TickFunctors" "IF(Combat() and not HasStatus('PATHOFUNDEATH_HEARTSTONE_BLOCKED')):ApplyStatus(PATHOFUNDEATH_HEARTSTONE_CHAR,100,0)"
data "Boosts" "IF(HasPassive('PathOfUndeath_Thayan',context.Source)):UnlockSpell(PathOfUndeath_Mortisurge,AddChildren,77fcde9b-9cda-4fbc-8806-393e26b2f3e1);IF(HasPassive('PathOfUndeath_Thayan',context.Source)):ActionResource(ShadowSpellSlot,1,6)"
data "Passives" "PathOfUndeath_HeartstoneToggle"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"
data "ApplyEffect" "33243729-1390-4bf2-8cd3-bb6b5efb3aa6"
data "OnRemoveFunctors" "RemoveStatus(AZARDON_HEART_TOGGLE);RemoveStatus(AZARDON_HEART_TOGGLED)"

//Mortisurge
//Damages foes with Necrotic damage, and heals ally Undead in AoE
new entry "PathOfUndeath_Mortisurge"
type "SpellData"
data "SpellType" "Target"
data "Level" "9"
data "SpellSchool" "Necromancy"
data "DisplayName" "h8e434b8fg7317g4c1fgb09dgf2b280035bd4;1"
data "Description" "h50b379cegf348g4801ga6adg8b0aa34acdf7;1"
data "DescriptionParams" "DealDamage(14d6,Necrotic);RegainHitPoints(4d6);DealDamage(2d6,Necrotic)"
data "TooltipDamageList" "RegainHitPoints(2d6)"
data "TooltipAttackSave" "Constitution"
data "TooltipOnSave" "cf82d985-c371-4c92-a380-e1cbd1c78e18"
data "TooltipStatusApply" "ApplyStatus(HARM,100,-1);ApplyStatus(PATHOFUNDEATH_MORTISURGE_FOE,100,3)"
data "Icon" "PoU_4_Mortisurge"
data "TargetRadius" "18"
data "TargetFloor" "-1"
data "AreaRadius" "9"
data "SpellProperties" "IF(Enemy()):CreateSurface(2,3,CloudkillCloud);IF(Enemy() and not IsInorganic()):ApplyStatus(PATHOFUNDEATH_MORTISURGE_FOE,100,3);IF(Enemy() and IsInorganic()):DealDamage((14d6)/2,Necrotic,Magical);IF(Ally() and Tagged('UNDEAD')):ApplyStatus(PATHOFUNDEATH_MORTISURGE_HEAL,100,0);IF(Ally() and not Tagged('UNDEAD')):DealDamage(2d6,Necrotic,Magical);IF(HasStatus('PATHOFUNDEATH_HELLFIRE')):CreateExplosion(PathOfUndeath_Dracolich_Explosion);IF(HasStatus('PATHOFUNDEATH_SPELLPLAGUE')):Force(-6, TargetToEntity, Neutral, false, true);RemoveStatus(PATHOFUNDEATH_UNHOLYCHALLENGER_HEALING)"
data "TargetConditions" "Character() or HasStatus('PATHOFUNDEATH_UNHOLYCHALLENGER_HEALING') or Dead()"
data "UseCosts" "ActionPoint:1;ShadowSpellSlot:1:1:6"
data "PrepareSound" "Spell_Prepare_Damage_Necrotic_Gen_L1to3"
data "PrepareLoopSound" "Spell_Prepare_Damage_Necrotic_Gen_L1to3_Loop"
data "CastSound" "Spell_Cast_Damage_Necrotic_CircleofDeath_L6to8"
data "TargetSound" "Spell_Impact_Damage_Necrotic_CircleofDeath_L6to8"
data "PreviewCursor" "Cast"
data "CastTextEvent" "Cast"
data "VerbalIntent" "Damage"
data "SpellFlags" "HasVerbalComponent;HasSomaticComponent;IsHarmful;IsSpell;HasHighGroundRangeExtension;CannotTargetItems"
data "SpellAnimation" "3ca3ec39-d0b9-42a5-b173-bc877d41339d,,;,,;6df470fd-9ba1-4b8f-bec2-f7ff22811ecd,,;1484b853-d893-4f48-bc0d-8bda8700462f,,;bd339475-d2b5-46e8-8d0c-9f2ad6a91328,,;,,;,,;,,;,,"
data "PrepareEffect" "5a90f50d-c9ae-47f3-8dd3-3054ee4a410a"
data "CastEffect" "ced71f50-d27c-47c2-b816-5a3ed78607fe"
data "PositionEffect" "051cdc72-08e5-4684-82ba-1d23fb8e219b"
data "DamageType" "Necrotic"

new entry "PATHOFUNDEATH_MORTISURGE_FOE"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Overwrite"
data "DisplayName" "h1477cbefg9b88g4105g9a6fgf6e5e68a6f3a;1"
data "Description" "h0d1ea7d3g2c42g4a74g82d6g60842250e851;1"
data "Icon" "PoU_4_Mortisurge_S"
data "OnApplyRoll" "not SavingThrow(Ability.Constitution, SourceSpellDC())"
data "OnApplySuccess" "ApplyStatus(PATHOFUNDEATH_MORTISURGE_HARM,100,-1)"
data "OnApplyFail" "DealDamage((14d6)/2,Necrotic,Magical)"
data "Boosts" "BlockRegainHP()"
data "Passives" "PathOfUndeath_Mortisurge_Weavewaned"
data "StatusEffect" "e69d85dc-f362-4c04-a0ea-42bfe568c24e"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead"

new entry "PATHOFUNDEATH_MORTISURGE_HARM"
type "StatusData"
data "StatusType" "BOOST"
using "HARM"
data "Boosts" "IncreaseMaxHP(-14d6-(MaxHP/4))"
data "StatusPropertyFlags" "InitiateCombat;BringIntoCombat;ApplyToDead"
data "StatusGroups" ""
data "StatusEffect" "16b6baae-fd4e-44fc-a98d-e52122c58c24"

new entry "PATHOFUNDEATH_MORTISURGE_HEAL"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "DisplayName" "h8e434b8fg7317g4c1fgb09dgf2b280035bd4;1"
data "OnApplyFunctors" "RegainHitPoints(4d6,Undead)"
data "ApplyEffect" "2665d5b2-717d-438f-91b4-73d4217e803d"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

//Unlife Pulse
new entry "PathOfUndeath_HeartstoneToggle"
type "PassiveData"
data "DisplayName" "h5019bdd9g753ag4eb6ga4a9g5775df004beb;1"
data "Description" "hc2df4761g2695g4427ga6bag21e2435cb2f8;1"
data "DescriptionParams" "DealDamage(1d6,Necrotic);RegainHitPoints(1d6)"
data "Icon" "PoU_4_UnlifePulse"
data "Properties" "IsToggled;ToggledDefaultOn;ToggledDefaultAddToHotbar"
data "ToggleOnFunctors" "RemoveStatus(PATHOFUNDEATH_HEARTSTONE_BLOCKED)"
data "ToggleOffFunctors" "ApplyStatus(PATHOFUNDEATH_HEARTSTONE_BLOCKED,100,-1)"

new entry "PATHOFUNDEATH_HEARTSTONE_BLOCKED"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

//Aura applied every turn 
//Deals 1d6 non boostable necrotic damage to enemies, and heals 1d6 undead allies
new entry "PATHOFUNDEATH_HEARTSTONE_CHAR"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "AuraRadius" "6"
data "AuraStatuses" "TARGET:IF(Character() and not Dead()):ApplyStatus(PATHOFUNDEATH_HEARTSTONE_EFFECT)"
data "ApplyEffect" "2b18d4f7-d599-4a7d-8619-f8971edea1e5"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

//Effect applied around wielder
new entry "PATHOFUNDEATH_HEARTSTONE_EFFECT"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "DisplayName" "h5019bdd9g753ag4eb6ga4a9g5775df004beb;1"
data "OnApplyFunctors" "IF(Enemy()):DealDamage(1d6,Necrotic,Magical,,0,,true);IF(Ally() and Tagged('UNDEAD')):RegainHitPoints(1d6,Undead)"
//data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "PathOfUndeath_Mortisurge_Weavewaned"
type "PassiveData" 
data "StatsFunctorContext" "OnAttacked;OnDamaged;OnDamagePrevented"
data "StatsFunctors" "IF(HasHPPercentageEqualOrLessThan(15)):Kill()"


//-------------------------------------------------------------------------------------------------------------------------------------
//Deathplane Umbralshard
//Gives Weavewane spell and Shadow Weave Veil passive
new entry "PoU_Shadowstone"
type "Object"
using "OBJ_Indestructible_Tiny"
data "StatusInInventory" "PATHOFUNDEATH_SHADOWSTONE_INV"

new entry "PATHOFUNDEATH_SHADOWSTONE"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "StatusEffect" "9162fa93-0550-455e-a03c-b5abe4f50585"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting"

new entry "PATHOFUNDEATH_SHADOWSTONE_INV"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "Boosts" "IF(HasPassive('PathOfUndeath_Thayan',context.Source)):UnlockSpell(PathOfUndeath_Weavewane,AddChildren,77fcde9b-9cda-4fbc-8806-393e26b2f3e1);IF(HasPassive('PathOfUndeath_Thayan',context.Source)):ActionResource(ShadowSpellSlot,1,6);StatusImmunity(PATHOFUNDEATH_SPELLPLAGUE);StatusImmunity(PATHOFUNDEATH_L_VOID_START);StatusImmunity(PATHOFUNDEATH_L_VOID_END)"
data "Passives" "PathOfUndeath_ShadowWeaveVeil"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"
data "ApplyEffect" "768bd17b-e59d-458b-b6ad-187db5b72313"
data "OnRemoveFunctors" "RemoveStatus(AZARDON_SHADOW_TOGGLE);RemoveStatus(AZARDON_SHADOW_TOGGLED)"

//Weavewane
new entry "PathOfUndeath_Weavewane"
type "SpellData"
data "SpellType" "Shout"
data "Level" "9"
data "SpellSchool" "Necromancy"
data "DisplayName" "h843f9846ga4f8g4ed9g830eg73e5dbd13583;1"
data "Description" "hb43558dagb59eg45e2ga0d4gec0e643df2ca;1"
data "DescriptionParams" "DealDamage(2d6,Cold);DealDamage(1d6,Necrotic)"
data "TooltipDamageList" "DealDamage(2d6,Cold);DealDamage(1d6,Necrotic)"
data "Icon" "PoU_4_Weavewane"
data "SpellProperties" "GROUND:Summon(622bffc0-7f5e-4a51-929a-b0dd928798fc, 10,Projectile_AiHelper_HungerOfHadar,,HungerOfHadar,PATHOFUNDEATH_WEAVEWANE)"
data "TargetConditions" "Character() and not Self()"
data "CastTextEvent" "Cast"
data "CycleConditions" "Enemy() and not Dead()"
data "UseCosts" "ActionPoint:1;ShadowSpellSlot:1:1:6"
data "VerbalIntent" "Damage"
data "SpellFlags" "HasVerbalComponent;HasSomaticComponent;HasHighGroundRangeExtension;IsHarmful;IsSpell"
data "HitAnimationType" "MagicalDamage_External"
data "DamageType" "Necrotic"
data "PrepareSound" "Spell_Prepare_Damage_Necrotic_Gen_L1to3"
data "PrepareLoopSound" "Spell_Prepare_Damage_Necrotic_Gen_L1to3_Loop"
data "CastSound" "Spell_Cast_Damage_Necrotic_CircleofDeath_L6to8"
data "TargetSound" "Spell_Impact_Damage_Necrotic_CircleofDeath_L6to8"
data "SpellAnimation" "f94542d9-a79c-478a-92de-573cead9260e,,;,,;821615de-23e4-4022-b8aa-b7977b071329,,;5a0d43d4-0aa3-4419-a44d-b40889925196,,;bd339475-d2b5-46e8-8d0c-9f2ad6a91328,,;,,;7a28f440-1b0b-4a18-96a8-3767959b601a,,;,,;,,"
data "PositionEffect" "051cdc72-08e5-4684-82ba-1d23fb8e219b"
data "CastEffect" "8502b53e-d2d7-4ec5-aa3b-e85f3be86991"
data "PrepareEffect" "d0c3a6f3-b954-4e8a-b9d2-8dfc66be24ab"

//Weavewaned
new entry "PATHOFUNDEATH_WEAVEWANE"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "DisplayName" "ha2d44fe2g72f9g455dg902cg3c7d6d45920b;1"
data "Description" "h51914cdcg8545g4bceg8d8dg422133c6d95f;1"
data "DescriptionParams" "DealDamage(1d6,Cold);DealDamage(1d6,Necrotic)"
data "Icon" "PoU_4_Weavewane_S"
data "SoundLoop" "Surf_Void_Cloud_ST_Start"
data "StackId" "VOID_AURA"
data "AuraRadius" "6"
data "AuraStatuses" "TARGET:IF(Character()):ApplyStatus(PATHOFUNDEATH_SPELLPLAGUE);TARGET:IF(Character()):ApplyStatus(PATHOFUNDEATH_L_VOID_START);TARGET:IF(Character()):ApplyStatus(PATHOFUNDEATH_L_VOID_END)"
data "Boosts" "GameplayObscurity(6)"
data "StatusEffect" "caeddf77-f14b-4214-97e9-b3f63e0f56d0"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;InitiateCombat;BringIntoCombat"

new entry "PATHOFUNDEATH_L_VOID_START"
type "StatusData"
data "StatusType" "BOOST"
using "VOID_START"
data "DisplayName" "ha2d44fe2g72f9g455dg902cg3c7d6d45920b;1"
data "Description" "h51914cdcg8545g4bceg8d8dg422133c6d95f;1"
data "DescriptionParams" "DealDamage(1d6,Cold);DealDamage(1d6,Necrotic)"
data "Icon" "PoU_4_Weavewane_S"
data "TooltipSave" ""
data "TickFunctors" "DealDamage(1d6,Cold,Magical,,0,,true);IF(not Tagged('BEAST') and not Tagged('HUMANOID') and not Tagged('UNDEAD')):DealDamage(1d6,Necrotic,Magical,,0,,true)"
data "OnApplyFunctors" "ApplyStatus(DIFFICULT_TERRAIN,100,-1);ApplyStatus(VOID_BLINDED, 100, -1);ApplyStatus(CHILLED,100,-1);ApplyStatus(PATHOFUNDEATH_ANTIMAGIC,100,-1);RemoveStatus(PATHOFUNDEATH_UNHOLYCHALLENGER_AURA_DEBUFF)"
data "OnRemoveFunctors" "RemoveStatus(DIFFICULT_TERRAIN);RemoveStatus(VOID_BLINDED);RemoveStatus(CHILLED);RemoveStatus(PATHOFUNDEATH_ANTIMAGIC)"
data "StatusEffectOnTurn" "ff9de642-4270-47e4-8fee-4e51f769a830"

new entry "PATHOFUNDEATH_L_VOID_END"
type "StatusData"
data "StatusType" "BOOST"
data "TickType" "EndTurn"
data "DisplayName" "ha2d44fe2g72f9g455dg902cg3c7d6d45920b;1"
data "Description" "h51914cdcg8545g4bceg8d8dg422133c6d95f;1"
data "DescriptionParams" "DealDamage(1d6,Cold);DealDamage(1d6,Necrotic)"
data "Icon" "PoU_4_Weavewane_S"
data "TooltipDamage" "DealDamage(1d6,Cold)"
data "TickFunctors" "ApplyStatus(PATHOFUNDEATH_L_VOID_END_DAMAGE,100,0)"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "PATHOFUNDEATH_L_VOID_END_DAMAGE"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "OnApplyFunctors" "DealDamage(1d6,Cold,Magical,,0,,true);IF(not Tagged('BEAST') and not Tagged('HUMANOID') and not Tagged('UNDEAD')):DealDamage(1d6,Necrotic,Magical,,0,,true)"
data "StatusEffectOnTurn" "f8b3d340-0839-4186-b6d9-00152706948b"

new entry "PATHOFUNDEATH_SPELLPLAGUE"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "DisplayName" "ha2d44fe2g72f9g455dg902cg3c7d6d45920b;1"
data "Description" "h51914cdcg8545g4bceg8d8dg422133c6d95f;1"
data "Icon" "PoU_4_Weavewane_S"
data "FormatColor" "Purple"
data "StackId" "UND_SUSSURTREEANTIMAGIC"
data "Boosts" "BlockSpellCast()"
data "OnApplyFunctors" "IF(HasPassive('AntimagicSusceptibility',context.Target)):ApplyStatus(INCAPACITATED_DND,100,1)"
data "TickFunctors" "IF(HasPassive('AntimagicSusceptibility',context.Target)):ApplyStatus(INCAPACITATED_DND,100,1);IF(HasActionResource('SpellSlot',1,6,false)):ApplyStatus(PATHOFUNDEATH_ANTIMAGIC_6,100,0);IF(not HasActionResource('SpellSlot',1,6,false) and HasActionResource('SpellSlot',1,5,false)):ApplyStatus(PATHOFUNDEATH_ANTIMAGIC_5,100,0);IF(not HasActionResource('SpellSlot',1,5,false) and HasActionResource('SpellSlot',1,4,false)):ApplyStatus(PATHOFUNDEATH_ANTIMAGIC_4,100,0);IF(not HasActionResource('SpellSlot',1,4,false) and HasActionResource('SpellSlot',1,3,false)):ApplyStatus(PATHOFUNDEATH_ANTIMAGIC_3,100,0);IF(not HasActionResource('SpellSlot',1,3,false) and HasActionResource('SpellSlot',1,2,false)):ApplyStatus(PATHOFUNDEATH_ANTIMAGIC_2,100,0);IF(not HasActionResource('SpellSlot',1,2,false) and HasActionResource('SpellSlot',1,1,false)):ApplyStatus(PATHOFUNDEATH_ANTIMAGIC_1,100,0);"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"
data "StatusEffect" "6bdb6241-83f9-4a31-a6e2-6946c6c65222"

new entry "PATHOFUNDEATH_ANTIMAGIC_1"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "ha2d44fe2g72f9g455dg902cg3c7d6d45920b;1"
data "Description" "h51914cdcg8545g4bceg8d8dg422133c6d95f;1"
data "Icon" "PoU_4_Weavewane_S"
data "OnApplyFunctors" "UseActionResource(SpellSlot,1,1);DealDamage(1d6,Necrotic,Magical,,0,,true);IF(HasStatus('PATHOFUNDEATH_OBLIVIONIZE_WEAVEWANED')):ApplyStatus(PATHOFUNDEATH_OBLIVIONIZE_WEAVEWANED,100,1)"
data "ApplyEffect" "768bd17b-e59d-458b-b6ad-187db5b72313"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "PATHOFUNDEATH_ANTIMAGIC_2"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_ANTIMAGIC_1"
data "OnApplyFunctors" "UseActionResource(SpellSlot,1,2);DealDamage(2d6,Necrotic,Magical,,0,,true);IF(HasStatus('PATHOFUNDEATH_OBLIVIONIZE_WEAVEWANED')):ApplyStatus(PATHOFUNDEATH_OBLIVIONIZE_WEAVEWANED,100,1)"

new entry "PATHOFUNDEATH_ANTIMAGIC_3"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_ANTIMAGIC_1"
data "OnApplyFunctors" "UseActionResource(SpellSlot,1,3);DealDamage(3d6,Necrotic,Magical,,0,,true);IF(HasStatus('PATHOFUNDEATH_OBLIVIONIZE_WEAVEWANED')):ApplyStatus(PATHOFUNDEATH_OBLIVIONIZE_WEAVEWANED,100,1)"

new entry "PATHOFUNDEATH_ANTIMAGIC_4"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_ANTIMAGIC_1"
data "OnApplyFunctors" "UseActionResource(SpellSlot,1,4);DealDamage(4d6,Necrotic,Magical,,0,,true);IF(HasStatus('PATHOFUNDEATH_OBLIVIONIZE_WEAVEWANED')):ApplyStatus(PATHOFUNDEATH_OBLIVIONIZE_WEAVEWANED,100,1)"

new entry "PATHOFUNDEATH_ANTIMAGIC_5"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_ANTIMAGIC_1"
data "OnApplyFunctors" "UseActionResource(SpellSlot,1,5);DealDamage(5d6,Necrotic,Magical,,0,,true);IF(HasStatus('PATHOFUNDEATH_OBLIVIONIZE_WEAVEWANED')):ApplyStatus(PATHOFUNDEATH_OBLIVIONIZE_WEAVEWANED,100,1)"

new entry "PATHOFUNDEATH_ANTIMAGIC_6"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_ANTIMAGIC_1"
data "OnApplyFunctors" "UseActionResource(SpellSlot,1,6);DealDamage(6d6,Necrotic,Magical,,0,,true);IF(HasStatus('PATHOFUNDEATH_OBLIVIONIZE_WEAVEWANED')):ApplyStatus(PATHOFUNDEATH_OBLIVIONIZE_WEAVEWANED,100,1)"

//Shadow Weave Veil
//Makes you more obscured & Immune to Blindness
new entry "PathOfUndeath_ShadowWeaveVeil"
type "PassiveData"
data "DisplayName" "h3aaab736gc508g4945ga88cg5b9f2890c3fa;1"
data "Description" "hd02db5dbg36feg4171gb034gfca7997a94a9;1"
data "Icon" "PoU_4_ShadowWeaveVeil"
data "Boosts" "GameplayObscurity(2);Attribute(ObscurityWithoutSneaking);Attribute(EnableObscurityEvents);StatusImmunity(SG_Blinded)"


//-------------------------------------------------------------------------------------------------------------------------------------
//Dark Rite - Replenish Phylactery
//Sacrifice 100% HP to replenish your Phylactery
new entry "PathOfUndeath_Replenish"
type "SpellData"
data "SpellType" "Shout"
data "Level" "8"
data "SpellSchool" "Necromancy"
data "SpellProperties" "ApplyStatus(PATHOFUNDEATH_L_REPLENISH,100,-1)"
data "TargetConditions" "Self()"
data "Icon" "PoU_4_ReplenishRite"
data "DisplayName" "h0c9ecfc7ga84eg472dg9756gde8cc22228a9;1"
data "Description" "h12613478gcb5dg450cg9efegb6021f64c030;1"
data "TooltipStatusApply" "ApplyStatus(PATHOFUNDEATH_PHYLACTERY_UP,100,-1)"
data "PrepareSound" "Spell_Prepare_Debuff_Gen_L1to3_01"
data "PrepareLoopSound" "Spell_Prepare_Debuff_Gen_L1to3_01_Loop"
data "CastSound" "Spell_Cast_Debuff_BestowCurse_L1to3"
data "TargetSound" "Spell_Impact_Debuff_BestowCurse_L1to3"
data "VocalComponentSound" "Vocal_Component_Curse"
data "CastTextEvent" "Cast"
data "UseCosts" "ActionPoint:1"
data "SpellAnimation" "414bbf02-2918-4f01-83fb-1ddc7a588d88,,;,,;4156d364-d2c0-4a01-908c-3552f78f434d,,;6f0a29b6-0ae8-4ebf-a1e4-8069c4a6ad16,,;0c5dcc83-fa78-41da-b6a5-440b5ea30936,,;,,;bea988a0-2ec5-40d8-a67e-ffbd7454bc53,,;,,;,,"
data "VerbalIntent" "Healing"
data "SpellFlags" "IsSpell;HasVerbalComponent;HasSomaticComponent;IsHarmful"
data "HitAnimationType" "MagicalNonDamage"
data "PrepareEffect" "556fd141-698d-4c08-9322-ad155821260a"
data "CastEffect" "09935316-bab7-4d4b-ad36-fd28963088a9"
data "TargetEffect" "de333436-aa42-45cc-a3da-14277ca1df60"
data "RequirementConditions" "HasStatus('PATHOFUNDEATH_PHYLACTERY_DOWN')"
data "Cooldown" "OncePerRest"

new entry "PATHOFUNDEATH_L_REPLENISH"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore" 
data "DisplayName" "h0c9ecfc7ga84eg472dg9756gde8cc22228a9;1"
//data "OnApplyFunctors" "IF(HasTemporaryHP()):DealDamage(MaxHP,Radiant,Magical,,0,,true,true,,true);IF(not HasTemporaryHP()):Kill()"
data "OnApplyFunctors" "IF(HasTemporaryHP()):ApplyStatus(PATHOFUNDEATH_L_REPLENISH_DAMAGE,100,0);IF(not HasTemporaryHP()):ApplyStatus(PATHOFUNDEATH_L_REPLENISH_KILL,100,0)"
data "OnRemoveFunctors" "IF(not IsDowned() and not Dead()):RemoveStatus(PATHOFUNDEATH_PHYLACTERY_DOWN)"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "PATHOFUNDEATH_L_REPLENISH_DAMAGE"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "DisplayName" "h0c9ecfc7ga84eg472dg9756gde8cc22228a9;1" 
data "OnApplyFunctors" "DealDamage(MaxHP,Radiant,Magical,,0,,true,true,,true)"
data "OnRemoveFunctors" "RemoveStatus(PATHOFUNDEATH_L_REPLENISH)"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "PATHOFUNDEATH_L_REPLENISH_KILL"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "DisplayName" "h0c9ecfc7ga84eg472dg9756gde8cc22228a9;1" 
data "OnApplyFunctors" "Kill()"
data "OnRemoveFunctors" "RemoveStatus(PATHOFUNDEATH_L_REPLENISH)"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

//-------------------------------------------------------------------------------------------------------------------------------------
//Dread Overlord
//-------------------------------------------------------------------------------------------------------------------------------------
//Unholy Rejuvenation
//Unholy Vigor interaction
//Heals user on receiving necrotic damage (even if immune)
new entry "PATHOFUNDEATH_L_UNHOLYVIGOR"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_UNHOLYVIGOR"
data "StackType" "Ignore"
data "Passives" "PathOfUndeath_Lichdom_UnholyVigor"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "StatusGroups" "SG_RemoveOnRespec"

new entry "PathOfUndeath_Lichdom_UnholyVigor"
type "PassiveData"
data "DisplayName" "h9fad0e8aga33dg41cbg9ae3gc266aa6823a5;1"
data "Description" "he4249c7cg033cg45aag9b8bg2dc5e9da65d8;1"
data "Icon" "PoU_4_UnholyVigor"
data "Properties" "Highlighted"

new entry "PATHOFUNDEATH_L_UNHOLYVIGOR_PROC"
type "StatusData"
data "StatusType" "BOOST"
data "OnApplyFunctors" "RegainHitPoints(max(1,ConstitutionModifier),Undead)"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "DreadOverlord_UnholyVigor"
type "PassiveData"
using "DreadOverlord_UnholyVigor"
data "StatsFunctorContext" "OnCreate"
data "StatsFunctors" "ApplyStatus(PATHOFUNDEATH_L_UNHOLYVIGORCHECK,100,-1)"

new entry "PATHOFUNDEATH_L_UNHOLYVIGORCHECK"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "StatusGroups" "SG_RemoveOnRespec"

//-------------------------------------------------------------------------------------------------------------------------------------
//Dark Urge
//-------------------------------------------------------------------------------------------------------------------------------------
//Improvement of power from Undeath
new entry "PATHOFUNDEATH_L_DURGE"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_U_DURGE"
data "StackPriority" "40"
data "Passives" "PathOfUndeath_L_Durge"

new entry "PathOfUndeath_L_Durge"
type "PassiveData"
using "PathOfUndeath_U_Durge"
data "Description" "h9e985aafgdc66g47beg816cg5fe5404985d0;1"
data "DescriptionParams" "DealDamage(4,Necrotic)"
data "Boosts" "IF(HasDamageDoneForType(DamageType.Necrotic) and not IsRedirectedDamage()):DamageBonus(4,Necrotic)"

//Deathbringer's Legacy
//Power Word Kill for your Phylactery charge
new entry "PathOfUndeath_L_DurgeCheck"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate"
data "StatsFunctors" "IF(HasPassive('Background_HauntedOne') or HasPassive('LODHauntedOne_Enigma')):ApplyStatus(PATHOFUNDEATH_PWK,100,-1)"

new entry "PATHOFUNDEATH_PWK"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "Passives" "PathOfUndeath_L_DurgePower"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

new entry "PathOfUndeath_L_DurgePower"
type "PassiveData"
data "DisplayName" "h90fd6505gb079g4aa4g9141g1a7fd81f7e92;1"
data "Description" "h4e18e814g626cg4e9dg8d1fg14032ffb1a3a;1"
data "Icon" "PoU_4_DeathbringersLegacy"
data "Properties" "Highlighted"
data "Boosts" "UnlockSpell(PathOfUndeath_L_Durge_PowerWordKill)"

new entry "PathOfUndeath_L_Durge_PowerWordKill"
type "SpellData"
data "SpellType" "Target"
using "Target_PowerWordKill"
data "SpellProperties" "ApplyStatus(SELF,PATHOFUNDEATH_PHYLACTERY_DOWN,100,-1)"
data "SpellRoll" "not SavingThrow(Ability.Wisdom, SourceSpellDC())"
data "SpellSuccess" "ApplyStatus(PATHOFUNDEATH_L_DURGE_PWK_KILL,100,0)"
data "SpellFail" "ApplyStatus(PATHOFUNDEATH_L_DURGE_PWK_DAMAGE,100,-1)"
data "SpellSchool" "Necromancy"
data "TargetRadius" "18"
data "TargetConditions" "Character() and not Dead() and not Tagged('UNDEAD') and not Tagged('CONSTRUCT')"
data "Icon" "PoU_4_PowerWordKill"
data "DisplayName" "h62636047g22a1g4d94g827bg3968d5be86b0;1"
data "Description" "h22991a6age499g4988g9b4eg1bd87c70060f;1"
data "DescriptionParams" "DealDamage(5d6+20,Necrotic)"
data "UseCosts" "ActionPoint:1"
data "RequirementConditions" "HasStatus('PATHOFUNDEATH_PHYLACTERY_UP')"
data "TooltipStatusApply" "ApplyStatus(PATHOFUNDEATH_PHYLACTERY_DOWN)"
data "PositionEffect" "93147aa8-98a2-4251-a476-ae30f5ce8c32"

new entry "PATHOFUNDEATH_L_DURGE_PWK_KILL"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "OnApplyFunctors" "Kill();SwitchDeathType(Explode)"
data "ApplyEffect" "951953e0-98f9-45be-af66-e63f9d946a60"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "PATHOFUNDEATH_L_DURGE_PWK_DAMAGE"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "OnApplyFunctors" "DealDamage(5d6+20,Necrotic,Magical)"
data "StatusEffect" "f86fa70a-3b45-4d97-9d15-62fbc417b369"
data "TargetGroundEffect"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"


//-------------------------------------------------------------------------------------------------------------------------------------
//Half-Illithid
//-------------------------------------------------------------------------------------------------------------------------------------
//Half-Alhoon
//Disambiguation passive
new entry "PathOfUndeath_L_HalfIllithid"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged;OnStatusApplied"
data "Conditions" "HasPassive('TAD_PartialCeremorph',context.Source)"
data "StatsFunctors" "IF(HasPassive('Siael_IllithidRecovery',context.Source)):ApplyStatus(PATHOFUNDEATH_L_HALFILLITHID_IPO,100,-1);IF(not HasPassive('Siael_IllithidRecovery',context.Source)):ApplyStatus(PATHOFUNDEATH_L_HALFILLITHID_VANILLA,100,-1)"

new entry "PATHOFUNDEATH_L_HALFILLITHID_VANILLA"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_HALFILLITHID"
data "StackType" "Ignore"
data "StackPriority" "10"
data "Passives" "PathOfUndeath_L_HalfIllithid_Vanilla"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

new entry "PATHOFUNDEATH_L_HALFILLITHID_IPO"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_HALFILLITHID_VANILLA"
data "StackPriority" "20"
data "Passives" "PathOfUndeath_L_HalfIllithid_IPO"

//Vanilla
//Damage done by Illithid Powers do +1d4 necrotic damage
new entry "PathOfUndeath_L_HalfIllithid_Vanilla"
type "PassiveData"
data "DisplayName" "h812b47e9g9d52g4b2bga91bg06e13930e89f;1"
data "Description" "h5fcde06fg6a36g4be6g842fg11b7a70156f5;1"
data "DescriptionParams" "DealDamage(1d4,Necrotic)"
data "Icon" "PoU_4_HalfAlhoon"
data "Properties" "Highlighted"
data "Boosts" "IF(IsTadpolePower() and HasFunctor(StatsFunctorType.DealDamage)):DamageBonus(1d4,Necrotic)"

//IPO specific
//Damage done by Illithid Powers do +1d4 necrotic damage +1 per Rank
new entry "PathOfUndeath_L_HalfIllithid_IPO"
type "PassiveData"
data "DisplayName" "h812b47e9g9d52g4b2bga91bg06e13930e89f;1"
data "Description" "h20ca28e5g1fe8g4d82ga2d2g12dd5e96343a;1"
data "DescriptionParams" "DealDamage(1d4,Necrotic);DealDamage(1,Necrotic)"
data "Icon" "PoU_4_HalfAlhoon"
data "Properties" "Highlighted"
data "Boosts" "IF(IPOMFDamageAbilities() and HasPassive('Siael_IllithidMind',context.Source)):DamageBonus(1d4,Necrotic);IF(IPOMFDamageAbilities() and HasPassive('Siael_IllithidMind_1',context.Source)):DamageBonus(1d4+1,Necrotic);IF(IPOMFDamageAbilities() and HasPassive('Siael_IllithidMind_2',context.Source)):DamageBonus(1d4+2,Necrotic);IF(IPOMFDamageAbilities() and HasPassive('Siael_IllithidMind_3',context.Source)):DamageBonus(1d4+3,Necrotic);IF(IPOMFDamageAbilities() and HasPassive('Siael_IllithidMind_4',context.Source)):DamageBonus(1d4+4,Necrotic);IF(IPOMFDamageAbilities() and HasPassive('Siael_IllithidMind_5',context.Source)):DamageBonus(1d4+5,Necrotic)"



//-------------------------------------------------------------------------------------------------------------------------------------
//Illithid
//-------------------------------------------------------------------------------------------------------------------------------------
//Alhoon
//Disambiguation passive
new entry "PathOfUndeath_L_Illithid"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "Conditions" "HasStatus('MIND_FLAYER_FORM',context.Source) or HasStatus('SIAEL_MIND_FLAYER_FORM_HUMAN',context.Source) or HasPassive('Siael_MindFlayer_Bonus',context.Source)"
data "StatsFunctors" "IF(HasPassive('Siael_IllithidRecovery',context.Source)):ApplyStatus(PATHOFUNDEATH_L_ILLITHID_IPO,100,-1);IF(not HasPassive('Siael_IllithidRecovery',context.Source)):ApplyStatus(PATHOFUNDEATH_L_ILLITHID_VANILLA,100,-1)"

new entry "PATHOFUNDEATH_L_ILLITHID_VANILLA"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_ILLITHID"
data "StackType" "Ignore"
data "StackPriority" "10"
data "Passives" "PathOfUndeath_L_Illithid_Vanilla"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

new entry "PATHOFUNDEATH_L_ILLITHID_IPO"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_ILLITHID_VANILLA"
data "StackPriority" "20"
data "Passives" "PathOfUndeath_L_Illithid_IPO"

//Vanilla
//Undead minions do +1d4 Psychic damage
new entry "PathOfUndeath_L_Illithid_Vanilla"
type "PassiveData"
data "DisplayName" "hc3953290gb5b2g4a03gb3e5gb64950befb04;1"
data "Description" "h2e96fb14g81e5g44f3g9cf9g303710055eef;1"
data "DescriptionParams" "DealDamage(1d4,Psychic)"
data "Icon" "PoU_4_Alhoon"
data "Properties" "Highlighted"
data "StatsFunctorContext" "OnCreate"
data "StatsFunctors" "ApplyStatus(PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA,100,-1)"

new entry "PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "DisplayName" "hc3953290gb5b2g4a03gb3e5gb64950befb04;1"
data "Icon" "PoU_4_Alhoon"
data "StackId" "PATHOFUNDEATH_L_ILLITHID_AURA"
data "AuraRadius" "24"
data "AuraStatuses" "TARGET:IF(Character() and Tagged('UNDEAD') and not Dead() and not Tagged('CONSTRUCT',context.Target) and Ally() and Tagged('SUMMON')):ApplyStatus(PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA_EFFECT)"
data "StatusPropertyFlags" "ApplyToDead;IgnoreResting"

new entry "PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA_EFFECT"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "DisplayName" "hc3953290gb5b2g4a03gb3e5gb64950befb04;1"
data "Description" "hccb52884gcb3bg45c2gbeddg1b8f4a9d5cac;1"
data "DescriptionParams" "DealDamage(1d4,Psychic)"
data "Icon" "PoU_4_Alhoon"
data "StackId" "PATHOFUNDEATH_L_ILLITHID_AURA_EFFECT"
data "Boosts" "IF(not Ally() and not IsRedirectedDamage()):DamageBonus(1d4,Psychic)"

//IPO specific
//Undead minions do +1d4 Psychic damage +1 per Rank
new entry "PathOfUndeath_L_Illithid_IPO"
type "PassiveData"
data "DisplayName" "hc3953290gb5b2g4a03gb3e5gb64950befb04;1"
data "Description" "h274d0f76g0c87g4c6cg9426g82a5015ff070;1"
data "DescriptionParams" "DealDamage(1d4,Psychic);DealDamage(1,Psychic)"
data "Icon" "PoU_4_Alhoon"
data "Properties" "Highlighted"
data "StatsFunctorContext" "OnCreate"
data "StatsFunctors" "IF(HasPassive('Siael_IllithidMind')):ApplyStatus(PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA,100,-1);IF(HasPassive('Siael_IllithidMind_1')):ApplyStatus(PATHOFUNDEATH_L_ILLITHID_IPO_AURA_1,100,-1);IF(HasPassive('Siael_IllithidMind_2')):ApplyStatus(PATHOFUNDEATH_L_ILLITHID_IPO_AURA_2,100,-1);IF(HasPassive('Siael_IllithidMind_3')):ApplyStatus(PATHOFUNDEATH_L_ILLITHID_IPO_AURA_3,100,-1);IF(HasPassive('Siael_IllithidMind_4')):ApplyStatus(PATHOFUNDEATH_L_ILLITHID_IPO_AURA_4,100,-1);IF(HasPassive('Siael_IllithidMind_5')):ApplyStatus(PATHOFUNDEATH_L_ILLITHID_IPO_AURA_5,100,-1);"

new entry "PATHOFUNDEATH_L_ILLITHID_IPO_AURA_1"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA"
data "AuraStatuses" "TARGET:IF(Character() and Tagged('UNDEAD') and not Dead() and not Tagged('CONSTRUCT',context.Target) and Ally() and Tagged('SUMMON')):ApplyStatus(PATHOFUNDEATH_L_ILLITHID_IPO_AURA_EFFECT_1)"

new entry "PATHOFUNDEATH_L_ILLITHID_IPO_AURA_2"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA"
data "AuraStatuses" "TARGET:IF(Character() and Tagged('UNDEAD') and not Dead() and not Tagged('CONSTRUCT',context.Target) and Ally() and Tagged('SUMMON')):ApplyStatus(PATHOFUNDEATH_L_ILLITHID_IPO_AURA_EFFECT_2)"

new entry "PATHOFUNDEATH_L_ILLITHID_IPO_AURA_3"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA"
data "AuraStatuses" "TARGET:IF(Character() and Tagged('UNDEAD') and not Dead() and not Tagged('CONSTRUCT',context.Target) and Ally() and Tagged('SUMMON')):ApplyStatus(PATHOFUNDEATH_L_ILLITHID_IPO_AURA_EFFECT_3)"

new entry "PATHOFUNDEATH_L_ILLITHID_IPO_AURA_4"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA"
data "AuraStatuses" "TARGET:IF(Character() and Tagged('UNDEAD') and not Dead() and not Tagged('CONSTRUCT',context.Target) and Ally() and Tagged('SUMMON')):ApplyStatus(PATHOFUNDEATH_L_ILLITHID_IPO_AURA_EFFECT_4)"

new entry "PATHOFUNDEATH_L_ILLITHID_IPO_AURA_5"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA"
data "AuraStatuses" "TARGET:IF(Character() and Tagged('UNDEAD') and not Dead() and not Tagged('CONSTRUCT',context.Target) and Ally() and Tagged('SUMMON')):ApplyStatus(PATHOFUNDEATH_L_ILLITHID_IPO_AURA_EFFECT_5)"

new entry "PATHOFUNDEATH_L_ILLITHID_IPO_AURA_EFFECT_1"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA_EFFECT"
data "DescriptionParams" "DealDamage(1d4+1,Psychic)"
data "Boosts" "IF(not Ally() and not IsRedirectedDamage()):DamageBonus(1d4+1,Psychic)"

new entry "PATHOFUNDEATH_L_ILLITHID_IPO_AURA_EFFECT_2"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA_EFFECT"
data "DescriptionParams" "DealDamage(1d4+2,Psychic)"
data "Boosts" "IF(not Ally() and not IsRedirectedDamage()):DamageBonus(1d4+2,Psychic)"

new entry "PATHOFUNDEATH_L_ILLITHID_IPO_AURA_EFFECT_3"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA_EFFECT"
data "DescriptionParams" "DealDamage(1d4+3,Psychic)"
data "Boosts" "IF(not Ally() and not IsRedirectedDamage()):DamageBonus(1d4+3,Psychic)"

new entry "PATHOFUNDEATH_L_ILLITHID_IPO_AURA_EFFECT_4"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA_EFFECT"
data "DescriptionParams" "DealDamage(1d4+4,Psychic)"
data "Boosts" "IF(not Ally() and not IsRedirectedDamage()):DamageBonus(1d4+4,Psychic)"

new entry "PATHOFUNDEATH_L_ILLITHID_IPO_AURA_EFFECT_5"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_L_ILLITHID_VANILLA_AURA_EFFECT"
data "DescriptionParams" "DealDamage(1d4+5,Psychic)"
data "Boosts" "IF(not Ally() and not IsRedirectedDamage()):DamageBonus(1d4+5,Psychic)"



//-------------------------------------------------------------------------------------------------------------------------------------
//Illithid Powers Overhaul 2
//-------------------------------------------------------------------------------------------------------------------------------------
//Mindslayer
new entry "PathOfUndeath_L_IPO_Buff_Giver"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(HasPassive('Siael_PsychicFortress_Distributor')):ApplyStatus(PATHOFUNDEATH_L_IPOBUFF,100,-1)"

new entry "PATHOFUNDEATH_L_IPOBUFF"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "Passives" "PathOfUndeath_L_IPO_Buff"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"


//More defense if you have Psychic Fortress
new entry "PathOfUndeath_L_IPO_Buff"
type "PassiveData"
data "DisplayName" "h664d738egb984g4020g8c6cg6120d5710d41;1"
data "Description" "h4b298f7dg8f37g448eg8044ga49e24a849c4;1"
data "Icon" "PoU_4_Kinbane"
data "Properties" "Highlighted"
data "Boosts" "Resistance(Psychic,Immune);Resistance(Force,Resistant)"



//-----------------------------------------------------------------------------------------------------------------------------------------
//Lichdom special buff
//-----------------------------------------------------------------------------------------------------------------------------------------
//Summon an Unholy Challenger from the body of Ansur 
new entry "PathOfUndeath_SummonUnholyChallenge"
type "SpellData"
data "SpellType" "Target"
data "Level" "9"
data "SpellSchool" "Necromancy"
data "SpellProperties" "SwitchDeathType(Explode);Spawn(64b2f580-a9cd-445e-80d7-94d24738436e);ApplyStatus(SELF,PATHOFUNDEATH_CHALLENGED,100,-1)"
data "TargetRadius" "9"
data "TargetConditions" "Dead() and HasStatus('PATHOFUNDEATH_ANSUR_AURA')"
data "Icon" "PoU_4_SummonChallenger"
data "DisplayName" "hca58ea77gb89cg4171g957cgba6506ce063d;1"
data "Description" "h68c5f720gdc4cg4613gb56cg34f3f17a1b89;1"
data "CastSound" "Spell_Cast_Damage_Necrotic_ArmsOfHadar_L1to3"
data "TargetSound" "Spell_Impact_Damage_Necrotic_ArmsOfHadar_L1to3"
data "VocalComponentSound" "Vocal_Component_DamageNecroticVamparic"
data "PreviewCursor" "Cast"
data "CastTextEvent" "Cast"
data "UseCosts" "ActionPoint:1"
data "SpellAnimation" "03496c4a-49e0-4132-b585-3e5ecd1ad8e5,,;,,;09ae2f11-f5b4-42f5-ae16-687a5b57d500,,;10caea0e-c949-4d91-8ab7-3b50019dd054,,;a9682ef9-5d9e-4ac0-8144-2c7fe6eb868c,,;,,;32fb4d91-7fde-4b05-9144-ea87b9a4284a,,;,,;,,"
data "VerbalIntent" "Summon"
data "SpellStyleGroup" "Class"
data "SpellFlags" "HasVerbalComponent;IsSpell;CannotTargetItems"
data "MemoryCost" "1"
data "PrepareEffect" "80a4c9a2-af28-4ba2-bcab-082c9d2ee0e4"
data "CastEffect" "104d98d3-1402-4fce-bab8-14df357d660e"
data "TargetEffect" "63def50f-b1fa-4394-81f6-539880d4e8a9"
data "PositionEffect" "051cdc72-08e5-4684-82ba-1d23fb8e219b"
data "DamageType" "Necrotic"

//Unholy Challenger stats
new entry "PathOfUndeath_UnholyChallenger"
type "Character"
using "_Undead"
data "Strength" "25"
data "Dexterity" "25"
data "Constitution" "25"
data "Intelligence" "25"
data "Wisdom" "25"
data "Charisma" "25"
data "Armor" "25"
data "Vitality" "500"
data "XPReward" "484393d9-eb7b-4b3b-b69b-5fdbfa940403"
data "Weight" "200"
data "Flags" "Floating"
data "DefaultBoosts" "ProficiencyBonus(SavingThrow,Strength);ProficiencyBonus(SavingThrow,Dexterity);ProficiencyBonus(SavingThrow,Constitution);ProficiencyBonus(SavingThrow,Wisdom);ProficiencyBonus(SavingThrow,Charisma);ProficiencyBonus(SavingThrow,Intelligence);IgnoreResistance(Necrotic,Immune)"
data "PersonalStatusImmunities" "BLEEDING;GAPING_WOUND;CHEST_TRAUMA;SG_Charmed;SG_Poisoned;SG_Incapacitated;SG_Stunned;SG_Polymorph;SG_Frightened;SG_Prone;SG_Sleeping;SG_Poisoned;SLEEPING;CHEST_TRAUMA;DAZED;SG_Fleeing;SG_Prone"
data "SpellCastingAbility" "Charisma"
data "UnarmedAttackAbility" "Strength"
data "ActionResources" "ActionPoint:2;BonusActionPoint:2;ReactionActionPoint:1"
data "Passives" "TurnResistance;AttackOfOpportunity;DarknessRules;Darkvision;DispelEvilAndGood_Charm_Check;DispelEvilAndGood_Frightened_Check;DispelEvilAndGood_Possessed_Check;ImmutableForm;ImmuneToControlUndead"
data "DarkvisionRange" "30"
data "Proficiency Group" "SimpleWeapons;MartialWeapons;LightArmor;MediumArmor;HeavyArmor"
data "DifficultyStatuses" "STATUS_EASY: HEALTHREDUCTION_EASYMODE; STATUS_EASY: APOSTLE_EASY; STATUS_NORMAL: APOSTLE_NORMAL; STATUS_HARD: HEALTHBOOST_HARDCORE"

//Excruciating Wither
//Applies debuffs in 12m
//Removable with Weavewane
new entry "PATHOFUNDEATH_UNHOLYCHALLENGER_AURA_DEBUFF"
type "StatusData"
data "StatusType" "BOOST"
using "APOSTLE_AURA"
data "Icon" "PoU_4_ExcruciatingWither"
data "DisplayName" "hf176fad9gafdbg48a4gb3c5g301b4cd231ce;1"
data "Description" "hfcf25870gacb9g49c7g825bgc22a16186399;1"
data "AuraRadius" "12"
data "AuraStatuses" "TARGET:IF(Character()):ApplyStatus(PATHOFUNDEATH_UNHOLYCHALLENGER_CURSETRIGGER)"

new entry "PATHOFUNDEATH_UNHOLYCHALLENGER_CURSETRIGGER"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "OnApplyFunctors" "ApplyStatus(PATHOFUNDEATH_UNHOLYCHALLENGER_CURSE,100,1)"
data "TickFunctors" "ApplyStatus(PATHOFUNDEATH_UNHOLYCHALLENGER_CURSE,100,1)"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

//Prevents healing and decreases max HP by 8 every turn
new entry "PATHOFUNDEATH_UNHOLYCHALLENGER_CURSE"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hf176fad9gafdbg48a4gb3c5g301b4cd231ce;1"
data "Description" "hf111aa68g5b8cg49d0g8979gb47959618ceb;1"
data "Icon" "PoU_4_ExcruciatingWither"
data "StackType" "Additive"
data "Boosts" "IncreaseMaxHP(-8);BlockRegainHP(Living;Undead)"
data "ApplyEffect" "8502b53e-d2d7-4ec5-aa3b-e85f3be86991"
data "EndEffect" "8690535a-06de-4441-b692-786f549ed262"
data "StatusPropertyFlags" "FreezeDuration;MultiplyEffectsByDuration"
data "RemoveEvents" "OnSourceDeath"
data "Passives" "PathOfUndeath_Challenger_SpellRot"

//Target takes 3d6 necrotic damage per spell level they cast
//If target is immune to necrotic, it still takes 25% of that damage
new entry "PathOfUndeath_Challenger_SpellRot"
type "PassiveData"
using "LOW_AncientLair_Curse_Hardcore"
data "DisplayName" "hf176fad9gafdbg48a4gb3c5g301b4cd231ce;1"
data "Description" "hf111aa68g5b8cg49d0g8979gb47959618ceb;1"
data "DescriptionParams" "DealDamage(3d6,Necrotic)"
data "StatsFunctors" "IF(SpellPowerLevelEqualTo(1)):ApplyStatus(PATHOFUNDEATH_SPELLROT1,100,1);IF(SpellPowerLevelEqualTo(2)):ApplyStatus(PATHOFUNDEATH_SPELLROT2,100,1);IF(SpellPowerLevelEqualTo(3)):ApplyStatus(PATHOFUNDEATH_SPELLROT3,100,1);IF(SpellPowerLevelEqualTo(4)):ApplyStatus(PATHOFUNDEATH_SPELLROT4,100,1);IF(SpellPowerLevelEqualTo(5)):ApplyStatus(PATHOFUNDEATH_SPELLROT5,100,1);IF(SpellPowerLevelEqualTo(6)):ApplyStatus(PATHOFUNDEATH_SPELLROT6,100,1)"
data "Properties" "IsHidden"

new entry "PATHOFUNDEATH_SPELLROT1"
type "StatusData"
data "StatusType" "BOOST"
using "LOW_ANCIENTLAIR_CURSE_DAMAGE_SPELLLEVEL1"
data "DisplayName" "hf176fad9gafdbg48a4gb3c5g301b4cd231ce;1"
data "DescriptionParams" "DealDamage(3d6,Necrotic)"
data "OnApplyFunctors" "DealDamage(3d6, Necrotic,Magical);IF(ConditionResult(context.Target.HasAllResistances({DamageType.Necrotic}, ResistanceType.Immune))):DealDamage((3d6)/4,Necrotic,Magical,,0,,,,,true)"

new entry "PATHOFUNDEATH_SPELLROT2"
type "StatusData"
data "StatusType" "BOOST"
using "LOW_ANCIENTLAIR_CURSE_DAMAGE_SPELLLEVEL2"
data "DisplayName" "hf176fad9gafdbg48a4gb3c5g301b4cd231ce;1"
data "DescriptionParams" "DealDamage(6d6,Necrotic)"
data "OnApplyFunctors" "DealDamage(6d6, Necrotic,Magical);IF(ConditionResult(context.Target.HasAllResistances({DamageType.Necrotic}, ResistanceType.Immune))):DealDamage((6d6)/4,Necrotic,Magical,,0,,,,,true)"

new entry "PATHOFUNDEATH_SPELLROT3"
type "StatusData"
data "StatusType" "BOOST"
using "LOW_ANCIENTLAIR_CURSE_DAMAGE_SPELLLEVEL3"
data "DisplayName" "hf176fad9gafdbg48a4gb3c5g301b4cd231ce;1"
data "DescriptionParams" "DealDamage(9d6,Necrotic)"
data "OnApplyFunctors" "DealDamage(9d6, Necrotic,Magical);IF(ConditionResult(context.Target.HasAllResistances({DamageType.Necrotic}, ResistanceType.Immune))):DealDamage((9d6)/4,Necrotic,Magical,,0,,,,,true)"

new entry "PATHOFUNDEATH_SPELLROT4"
type "StatusData"
data "StatusType" "BOOST"
using "LOW_ANCIENTLAIR_CURSE_DAMAGE_SPELLLEVEL4"
data "DisplayName" "hf176fad9gafdbg48a4gb3c5g301b4cd231ce;1"
data "DescriptionParams" "DealDamage(12d6,Necrotic)"
data "OnApplyFunctors" "DealDamage(12d6, Necrotic,Magical);IF(ConditionResult(context.Target.HasAllResistances({DamageType.Necrotic}, ResistanceType.Immune))):DealDamage((12d6)/4,Necrotic,Magical,,0,,,,,true)"

new entry "PATHOFUNDEATH_SPELLROT5"
type "StatusData"
data "StatusType" "BOOST"
using "LOW_ANCIENTLAIR_CURSE_DAMAGE_SPELLLEVEL5"
data "DisplayName" "hf176fad9gafdbg48a4gb3c5g301b4cd231ce;1"
data "DescriptionParams" "DealDamage(15d6,Necrotic)"
data "OnApplyFunctors" "DealDamage(15d6, Necrotic,Magical);IF(ConditionResult(context.Target.HasAllResistances({DamageType.Necrotic}, ResistanceType.Immune))):DealDamage((15d6)/4,Necrotic,Magical,,0,,,,,true)"

new entry "PATHOFUNDEATH_SPELLROT6"
type "StatusData"
data "StatusType" "BOOST"
using "LOW_ANCIENTLAIR_CURSE_DAMAGE_SPELLLEVEL6"
data "DisplayName" "hf176fad9gafdbg48a4gb3c5g301b4cd231ce;1"
data "DescriptionParams" "DealDamage(18d6,Necrotic)"
data "OnApplyFunctors" "DealDamage(18d6, Necrotic,Magical);IF(ConditionResult(context.Target.HasAllResistances({DamageType.Necrotic}, ResistanceType.Immune))):DealDamage((18d6)/4,Necrotic,Magical,,0,,,,,true)"

//Eternal Resilience
//Invulnerable, removable using Oblivionize
new entry "PATHOFUNDEATH_UNHOLYCHALLENGER_ARMOR"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "Icon" "PoU_4_EternalResilience"
data "DisplayName" "h49cf1b85gb9c6g4c91g9c4agf863ab202277;1"
data "Description" "h9f6e6537g6308g4e78g954eg0d13afb81cb7;1"
data "Boosts" "Invulnerable()"

//Torment Unending
//Heal every turn, removable using Mortisurge
new entry "PATHOFUNDEATH_UNHOLYCHALLENGER_HEALING"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "Icon" "PoU_4_TormentUnending"
data "DisplayName" "h971e4b6bg1ce6g42b1ga7bag4011749c0309;1"
data "Description" "h84ebd8edg8115g4e87g836ag52d6c861b428;1"
data "TickFunctors" "RegainHitPoints(MaxHP,Guaranteed)"

//Desecrated Presence
//Kills the living, not removable
new entry "PATHOFUNDEATH_UNHOLYCHALLENGER_AURA_FINAL"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_UNHOLYCHALLENGER_AURA"
data "Icon" "PoU_4_DesecratedPresence"
data "DisplayName" "hfe14cf9bge6eag473fgb8dag414a4d4b9925;1"
data "Description" "ha8eeee5dgb3cbg4d43gb3cbgfe03162e96a6;1"
data "Boosts" "IgnoreResistance(Necrotic,Immune);Tag(CHASM_IMMUNE);Attribute(Grounded)"
data "AuraRadius" "100"
data "AuraStatuses" "TARGET:IF(Character() and not (Tagged('UNDEAD') or HasPassive('InuredtoUndeath')) and not Dead()):ApplyStatus(PATHOFUNDEATH_DIE)"
//data "OnRemoveFunctors" "IF(RemoveCause(StatusRemoveCause.Death)):CreateExplosion(PathOfUndeath_L_BuffGiver)"
data "StatusPropertyFlags" "IgnoreResting;ApplyToDead"

new entry "PATHOFUNDEATH_DIE"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "OnApplyFunctors" "Kill()"
data "TickFunctors" "Kill()"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

//Gives the buff upon being defeated
//new entry "PathOfUndeath_L_BuffGiver"
//type "SpellData"
//data "SpellType" "Projectile"
//data "AreaRadius" "50"
//data "ExplodeRadius" "50"
//data "SpellProperties" "IF(HasStatus('PATHOFUNDEATH_LICHDOM')):ApplyStatus(PATHOFUNDEATH_L_BUFF,100,-1)"
//data "Trajectories" "cef7e2cd-4c6b-4c23-b2c4-b9c0ae69311d"




//Buff given by slaying the Unholy Challenger
new entry "PATHOFUNDEATH_L_BUFF"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "Passives" "PathOfUndeath_LichdomBuff"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"
data "TickFunctors" "IF(Tagged('WARLOCK_DREAD_OVERLORD')):ApplyStatus(PATHOFUNDEATH_L_DREADBUFF,100,-1)"

//Aeonian Being
//Similar to Reliable Talent
new entry "PathOfUndeath_LichdomBuff"
type "PassiveData"
data "DisplayName" "hfefba723g59cag4b9bgba98g2f9f0ccbec64;1"
data "Description" "hc37fbea3gaeddg4216gb07cgdf9e69b4aaae;1"
data "Icon" "PoU_4_ReliableTalent"
data "Properties" "Highlighted"
data "Boosts" "IF(HasProficiencyBonus(context.CheckedAbility,context.CheckedSkill,context.Source)):Reroll(RawAbility,10,false);IF(HasProficiencyBonus(context.CheckedAbility,context.CheckedSkill,context.Source)):Reroll(SkillCheck,10,false);IF(HasProficiencyBonus(context.CheckedAbility,context.CheckedSkill,context.Source)):Reroll(SavingThrow,10,false)"


//-------------------------------------------------------------------------------------------------------------------------------------
//Dread Overlord special buff
//-------------------------------------------------------------------------------------------------------------------------------------
//Deathmarch
//One action-free necromancy spell per turn
new entry "PATHOFUNDEATH_L_DREADBUFF"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "Passives" "PathOfUndeath_L_DreadBuff;PathOfUndeath_L_Avatar"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"
data "StatusGroups" "SG_RemoveOnRespec"

new entry "PathOfUndeath_L_DreadBuff"
type "PassiveData"
data "DisplayName" "h116ae1d4gdf7eg4b34g9154g0d0e185e69dc;1"
data "Description" "h5619c61dg92b9g4a83gb5ecgf69ddbb553e0;1"
data "Icon" "PoU_4_Deathmarch"
data "Properties" "Highlighted;OncePerTurn"
data "StatsFunctorContext" "OnTurn"
data "StatsFunctors" "ApplyStatus(PATHOFUNDEATH_L_DREADBUFF_USE,100,1)"

new entry "PATHOFUNDEATH_L_DREADBUFF_USE"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "PATHOFUNDEATH_L_DREADBUFF_USE"
data "StackType" "Ignore"
data "StackPriority" "10"
data "DisplayName" "h116ae1d4gdf7eg4b34g9154g0d0e185e69dc;1"
data "Description" "h0a7d4f0ag55beg42e0gb2d6g7e5ed9eb635d;1"
data "Icon" "PoU_4_Deathmarch"
data "Boosts" "UnlockSpellVariant(PoU_DeathmarchCheck(), ModifyUseCosts(Replace,ActionPoint,0,0,ActionPoint),ModifyIconGlow(),ModifyTooltipDescription())"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;FreezeDuration"
data "RemoveEvents" "OnSpellCast"
data "RemoveConditions" "HasSpellFlag(SpellFlags.Spell) and IsSpellOfSchool(SpellSchool.Necromancy)"



//-------------------------------------------------------------------------------------------------------------------------------------
////Dracolich Form
//-------------------------------------------------------------------------------------------------------------------------------------
new entry "PathOfUndeath_L_Avatar"
type "PassiveData"
data "DisplayName" "h1bb3e9e9ga4d4g47d8g803ag3852a8613199;1"
data "Description" "hc50aa443gdc67g4159ga8bcg794cb71b51aa;1"
data "Icon" "PoU_4_Dracolich3"
data "Boosts" "UnlockSpell(PathOfUndeath_DracolichdomRitual)"

new entry "PathOfUndeath_DracolichdomRitual"
type "SpellData"
data "SpellType" "Shout"
using "Shout_DreadOverlord_DracolichdomRitual"
data "Icon" "PoU_4_Dracolich"
data "SpellProperties" "ApplyStatus(PATHOFUNDEATH_DRACOLICH_SHAPESHIFT,100,-1)"
data "TooltipStatusApply" "ApplyStatus(PATHOFUNDEATH_DRACOLICH_SHAPESHIFT,100,-1)"
data "RequirementConditions" "not HasStatus('PATHOFUNDEATH_DRACOLICH_SHAPESHIFT')"
data "PrepareEffect" "23425182-fc69-41a7-9a88-3dbd865abd46"

new entry "PATHOFUNDEATH_DRACOLICH_SHAPESHIFT"
type "StatusData"
data "StatusType" "POLYMORPHED"
using "DREADOVERLORD_DRACOLICH_SHAPESHIFT"
data "Icon" "PoU_4_Dracolich3"
data "Boosts" "UnlockSpell(Shout_DreadOverlord_DracolichdomRitual_Cancel);ScaleMultiplier(2);Attribute(Grounded);UnlockSpell(PathOfUndeath_Dracolich_Fly);UnlockSpell(PathOfUndeath_Dracolich_Breath);StatusImmunity(BURNING);StatusImmunity(BURNING_HELLFIRE);StatusImmunity(BLINDED);StatusImmunity(DIFFICULT_TERRAIN);StatusImmunity(VOID_CLOUD);DialogueBlock()"
data "StatusEffect" "VFX_Status_FloatingHeadVFX_Eyes_01:Dummy_EyeFX_01;VFX_Status_FloatingHeadVFX_Eyes_02:Dummy_EyeFX_02;VFX_Status_FloatingHeadVFX_Mouth_01:Dummy_MouthFX"
data "OnApplyFunctors" "ApplyStatus(PATHOFUNDEATH_DRACOLICH_SHAPESHIFT4,100,-1);ApplyStatus(PATHOFUNDEATH_DRACOLICH_SHAPESHIFT5,100,-1);ApplyStatus(PATHOFUNDEATH_DRACOLICH_SHAPESHIFT6,100,-1);ApplyStatus(PATHOFUNDEATH_DRACOLICH_SHAPESHIFT7,100,-1);CreateExplosion(PathOfUndeath_Dracolich_Explosion)"
data "OnRemoveFunctors" "RemoveStatus(PATHOFUNDEATH_DRACOLICH_SHAPESHIFT4);RemoveStatus(PATHOFUNDEATH_DRACOLICH_SHAPESHIFT5);RemoveStatus(PATHOFUNDEATH_DRACOLICH_SHAPESHIFT6);RemoveStatus(PATHOFUNDEATH_DRACOLICH_SHAPESHIFT7)"
data "Passives" "PathOfUndeath_Dracolich_Strength;PathOfUndeath_Dracolich_Caster;PathOfUndeath_Dracolich_TrailStart;PathOfUndeath_Dracolich_TrailEnd"
data "StatusEffect" "VFX_Status_Apostle_MyrkulsBoon_DummyFX_01:Dummy_ChestFX;VFX_Status_DreadOverlord_DracolichdomForm_ChestFX_01:Dummy_BodyFX;VFX_Status_FloatingHeadVFX_Eyes_01:Dummy_EyeFX_01;VFX_Status_FloatingHeadVFX_Eyes_02:Dummy_EyeFX_02;VFX_Status_FloatingHeadVFX_Mouth_01:Dummy_MouthFX"

new entry "Shout_DreadOverlord_DracolichdomRitual_Cancel"
type "SpellData"
data "SpellType" "Shout"
using "Shout_DreadOverlord_DracolichdomRitual_Cancel"
data "Icon" "PoU_4_Dracolich2"

new entry "PathOfUndeath_Dracolich_Breath"
type "SpellData"
data "SpellType" "Zone"
data "Level" "9"
data "SpellSchool" "Necromancy"
data "SpellProperties" "GROUND:SurfaceChange(Ignite);GROUND:SurfaceChange(Melt);GROUND:CreateSurface(1,2,VoidCloud);GROUND:CreateSurface(1,1,Hellfire);TARGET:IF(Item()):ApplyStatus(BURNING,100,2)"
data "SpellSuccess" "DealDamage(5d10,Fire,Magical);DealDamage(5d10,Necrotic,Magical);Force(3,OriginToEntity,Aggressive)"
data "SpellFail" "DealDamage((5d10)/2,Fire,Magical);DealDamage((5d10)/2,Necrotic,Magical)"
data "Icon" "PoU_4_BlackflameBreath"
data "DisplayName" "h6dd11439g99dbg4066g82d2g54bcf7e6deec;1"
data "Description" "h7e71fbbdga139g435dga8ebg01708a971b3e;1"
data "DescriptionParams" "DealDamage(5d10,Fire);DealDamage(5d10,Necrotic);Distance(3)"
data "TooltipDamageList" "DealDamage(5d10,Fire);DealDamage(5d10,Necrotic)"
data "PrepareSound" "Spell_Prepare_Damage_BreathWeapon_Fire"
data "PrepareLoopSound" "Spell_Loop_Damage_BreathWeapon_Fire"
data "CastSound" "Spell_Cast_Damage_BreathWeapon_Fire"
data "Shape" "Cone"
data "Angle" "60"
data "DamageType" "Necrotic"
data "SurfaceType" "Hellfire"
data "SurfaceLifetime" "0"
data "SurfaceGrowStep" "5"
data "SurfaceGrowInterval" "5"
data "SpellRoll" " not SavingThrow(Ability.Dexterity, SourceSpellDC())"
data "TooltipAttackSave" "Dexterity"
data "TooltipOnSave" "961753f4-c345-4bc4-b408-1d5b87a5ab0c"
data "CastTextEvent" "Cast"
data "Range" "12"
data "Base" "2"
data "UseCosts" "BonusActionPoint:1"
data "Cooldown" "OncePerTurn"
data "SpellFlags" "CanAreaDamageEvade;IsHarmful;IsSpell;HasHighGroundRangeExtension;Temporary"
data "PrepareEffect" "a6389f1d-b548-41f0-b236-62172c1dab04"
data "CastEffect" "98b7ae23-97a3-434f-9b04-ebe4221045c1"
data "TargetEffect" "40098331-35ed-4980-a87b-e40dccce80f9"
data "HitEffect" "d6523ec5-4f58-402c-8129-81059fde2db5"
data "SpellAnimation" "f94542d9-a79c-478a-92de-573cead9260e,,;,,;821615de-23e4-4022-b8aa-b7977b071329,,;5a0d43d4-0aa3-4419-a44d-b40889925196,,;bd339475-d2b5-46e8-8d0c-9f2ad6a91328,,;,,;7a28f440-1b0b-4a18-96a8-3767959b601a,,;,,;,,"

new entry "PathOfUndeath_Dracolich_Strength"
type "PassiveData"
data "DisplayName" "h20d26f54gb19fg4aa9gbfd6g4d0c67bc1272;1"
data "Description" "h213a426fg08deg44a8g8654gf32e2c78d603;1"
data "Icon" "PoU_4_Dracolich3"
data "Properties" "Highlighted"
data "Boosts" "IF(IsRangedWeaponAttack()):DamageBonus(StrengthModifier);IF(IsMeleeWeaponAttack()):DamageBonus(StrengthModifier*2)"

new entry "PathOfUndeath_Dracolich_Caster"
type "PassiveData"
data "DisplayName" "h4cb1c8b9g0ac2g4f14g96d7gb94a61132bed;1"
data "Description" "h34e2b783gc32fg4d13g8236g1807d967214e;1"
data "Icon" "PoU_4_Dracolich3"
data "Properties" "Highlighted"
data "Boosts" "IF(IsSpell() and not IsSpellOfSchool(SpellSchool.Necromancy)):DamageBonus(SpellCastingAbilityModifier);IF(IsSpell() and IsSpellOfSchool(SpellSchool.Necromancy)):DamageBonus(SpellCastingAbilityModifier*2)"

new entry "PathOfUndeath_Dracolich_Fly"
type "SpellData"
data "SpellType" "Projectile"
using "Projectile_Fly"
data "TargetRadius" "36"
data "UseCosts" "Movement:Distance*0.5"
data "SpellFlags" "IsJump;HasHighGroundRangeExtension;IgnoreVisionBlock;RangeIgnoreVerticalThreshold;Stealth;Invisible;CannotTargetCharacter;CannotTargetItems;Temporary"
data "PrepareEffect" "e10fa2ab-984e-4ab7-b756-4982dfca4018"
data "CastEffect" "8b2df096-373b-4323-b5bc-6cf2c3db8281"

new entry "PathOfUndeath_Dracolich_TrailStart"
type "PassiveData"
data "StatsFunctorContext" "OnCast"
data "Conditions" "SpellCategoryIs(SpellCategory.Jump)"
data "StatsFunctors" "ApplyStatus(PATHOFUNDEATH_DRACOLICH_TRAIL,100,1)"

new entry "PathOfUndeath_Dracolich_TrailEnd"
type "PassiveData"
data "StatsFunctorContext" "OnCastResolved"
data "Conditions" "SpellCategoryIs(SpellCategory.Jump)"
data "StatsFunctors" "RemoveStatus(PATHOFUNDEATH_DRACOLICH_TRAIL)"

new entry "PATHOFUNDEATH_DRACOLICH_TRAIL"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "PATHOFUNDEATH_DRACOLICH_TRAIL2"
type "StatusData"
data "StatusType" "BOOST"
data "OnApplyFunctors" "GROUND:SurfaceChange(Ignite);SurfaceChange(Ignite);GROUND:SurfaceChange(Melt);CreateSurface(3,1,VoidCloud);IF(not InSurface('SurfaceHellfire',context.Source)):CreateSurface(1,1,Hellfire)"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"

new entry "PathOfUndeath_Dracolich_Explosion"
type "SpellData"
data "SpellType" "Projectile"
using "Projectile_Fireball"
data "SpellSchool" "Necromancy"
data "SpellProperties" "GROUND:SurfaceChange(Ignite);GROUND:SurfaceChange(Melt);CreateSurface(4,1,VoidCloud);CreateSurface(4,1,Hellfire)"
data "TargetFloor" "-1"
data "TargetRadius" "18"
data "AreaRadius" "4"
data "ExplodeRadius" "4"
data "SpellRoll" "not SavingThrow(Ability.Dexterity, SourceSpellDC()) "
data "SpellSuccess" "DealDamage(5d10,Fire,Magical);DealDamage(5d10,Necrotic,Magical)"
data "SpellFail" "DealDamage((5d10)/2,Fire,Magical);DealDamage((5d10)/2,Necrotic,Magical)"
data "TargetConditions" "not Self() and not (HasPassive('SculptSpells', context.Source) and Ally())"
data "ProjectileCount" "1"
data "Trajectories" "f5855e43-2e8f-4971-b8c2-7faa36e3381b"
data "DisplayName" "hb04f604age7d6g4360g8517g4fde72a6d471;1"
data "Description" "ha4ef73e8g1374g4aaagb497gd9e1126ad648;1"
data "TooltipDamageList" "DealDamage(5d10,Fire);DealDamage(5d10,Necrotic)"
data "UseCosts" ""
data "SpellFlags" "IsSpell;IsHarmful;CanAreaDamageEvade"
data "MemoryCost" ""
data "PrepareEffect" "fdbf8e88-c3a5-4151-a81d-429985de422c"
data "CastEffect" "69aaec35-fb5f-489e-a4cc-47310f4377e9"
data "HitEffect" "41de42e1-56d0-4336-8b44-99fc38281525"
data "DamageType" "Fire"

//-------------------------------------------------------------------------------------------------------------------------------------
//VFX
new entry "PATHOFUNDEATH_DRACOLICH_SHAPESHIFT2"
type "StatusData"
data "StatusType" "BOOST"
data "StackType" "Ignore"
data "StatusEffect" "0fa0ad76-792a-4bec-b5db-8fca8581602a"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

//new entry "PATHOFUNDEATH_DRACOLICH_SHAPESHIFT3"
//type "StatusData"
//data "StatusType" "BOOST"
//using "PATHOFUNDEATH_DRACOLICH_SHAPESHIFT2"
//data "StatusEffect" "5fb07a4f-4d82-4777-a4b0-6792a93b938e"

new entry "PATHOFUNDEATH_DRACOLICH_SHAPESHIFT4"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_DRACOLICH_SHAPESHIFT2"
data "StatusEffect" "d2ec72fd-2375-4999-8197-71fefc86cd72"

new entry "PATHOFUNDEATH_DRACOLICH_SHAPESHIFT5"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_DRACOLICH_SHAPESHIFT2"
data "StatusEffect" "d0c3a6f3-b954-4e8a-b9d2-8dfc66be24ab"

new entry "PATHOFUNDEATH_DRACOLICH_SHAPESHIFT6"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_DRACOLICH_SHAPESHIFT2"
data "StatusEffect" "d6422dfb-0caa-4354-8d63-26489afff4a0"

new entry "PATHOFUNDEATH_DRACOLICH_SHAPESHIFT7"
type "StatusData"
data "StatusType" "BOOST"
using "PATHOFUNDEATH_DRACOLICH_SHAPESHIFT2"
data "StatusEffect" "3ce4d62e-4969-42c2-9fa6-f715a73ae77e"
